var Transport=(function(){var b=0,e={},a,g;function h(i){utils.bindAll(this);i=utils.isString(i)?{url:i}:i;g=g||new RequestCache();a=utils.isNumber(i.maxParallelRequests)?i.maxParallelRequests:a||6;this.url=i.url;this.wildcard=i.wildcard||"%QUERY";this.filter=i.filter;this.replace=i.replace;this.ajaxSettings={type:"get",cache:i.cache,timeout:i.timeout,dataType:i.dataType||"json",beforeSend:i.beforeSend};this._get=(/^throttle$/i.test(i.rateLimitFn)?utils.throttle:utils.debounce)(this._get,i.rateLimitWait||300)}utils.mixin(h.prototype,{_get:function(k,i){var l=this;if(d()){this._sendRequest(k).done(j)}else{this.onDeckRequestArgs=[].slice.call(arguments,0)}function j(n){var m=l.filter?l.filter(n):n;i&&i(m);g.set(k,n)}},_sendRequest:function(j){var l=this,k=e[j];if(!k){c();k=e[j]=$.ajax(j,this.ajaxSettings).always(i)}return k;function i(){f();e[j]=null;if(l.onDeckRequestArgs){l._get.apply(l,l.onDeckRequestArgs);l.onDeckRequestArgs=null}}},get:function(m,i){var l=this,k=encodeURIComponent(m||""),j,n;i=i||utils.noop;j=this.replace?this.replace(this.url,k):this.url.replace(this.wildcard,k);if(n=g.get(j)){utils.defer(function(){i(l.filter?l.filter(n):n)})}else{this._get(j,i)}return !!n}});return h;function c(){b++}function f(){b--}function d(){return b<a}})();