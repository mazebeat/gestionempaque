var InputView=(function(){function b(e){var d=this;utils.bindAll(this);this.specialKeyCodeMap={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"};this.$hint=$(e.hint);this.$input=$(e.input).on("blur.tt",this._handleBlur).on("focus.tt",this._handleFocus).on("keydown.tt",this._handleSpecialKeyEvent);if(!utils.isMsie()){this.$input.on("input.tt",this._compareQueryToInputValue)}else{this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(f){if(d.specialKeyCodeMap[f.which||f.keyCode]){return}utils.defer(d._compareQueryToInputValue)})}this.query=this.$input.val();this.$overflowHelper=c(this.$input)}utils.mixin(b.prototype,EventTarget,{_handleFocus:function(){this.trigger("focused")},_handleBlur:function(){this.trigger("blured")},_handleSpecialKeyEvent:function(d){var e=this.specialKeyCodeMap[d.which||d.keyCode];e&&this.trigger(e+"Keyed",d)},_compareQueryToInputValue:function(){var d=this.getInputValue(),f=a(this.query,d),e=f?this.query.length!==d.length:false;if(e){this.trigger("whitespaceChanged",{value:this.query})}else{if(!f){this.trigger("queryChanged",{value:this.query=d})}}},destroy:function(){this.$hint.off(".tt");this.$input.off(".tt");this.$hint=this.$input=this.$overflowHelper=null},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(d){this.query=d},getInputValue:function(){return this.$input.val()},setInputValue:function(e,d){this.$input.val(e);!d&&this._compareQueryToInputValue()},getHintValue:function(){return this.$hint.val()},setHintValue:function(d){this.$hint.val(d)},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},isOverflow:function(){this.$overflowHelper.text(this.getInputValue());return this.$overflowHelper.width()>this.$input.width()},isCursorAtEnd:function(){var e=this.$input.val().length,f=this.$input[0].selectionStart,d;if(utils.isNumber(f)){return f===e}else{if(document.selection){d=document.selection.createRange();d.moveStart("character",-e);return e===d.text.length}}return true}});return b;function c(d){return $("<span></span>").css({position:"absolute",left:"-9999px",visibility:"hidden",whiteSpace:"nowrap",fontFamily:d.css("font-family"),fontSize:d.css("font-size"),fontStyle:d.css("font-style"),fontVariant:d.css("font-variant"),fontWeight:d.css("font-weight"),wordSpacing:d.css("word-spacing"),letterSpacing:d.css("letter-spacing"),textIndent:d.css("text-indent"),textRendering:d.css("text-rendering"),textTransform:d.css("text-transform")}).insertAfter(d)}function a(e,d){e=(e||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ");d=(d||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ");return e===d}})();