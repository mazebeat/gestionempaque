(function(n){var e=/\S/,j=/\"/g,o=/\n/g,k=/\r/g,t=/\\/g;n.tags={"#":1,"^":2,"<":3,"$":4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12};n.scan=function l(F,A){var N=F.length,x=0,C=1,w=2,y=x,B=null,P=null,O="",I=[],E=false,M=0,J=0,G="{{",L="}}";function K(){if(O.length>0){I.push({tag:"_t",text:new String(O)});O=""}}function z(){var R=true;for(var Q=J;Q<I.length;Q++){R=(n.tags[I[Q].tag]<n.tags._v)||(I[Q].tag=="_t"&&I[Q].text.match(e)===null);if(!R){return false}}return R}function H(T,Q){K();if(T&&z()){for(var R=J,S;R<I.length;R++){if(I[R].text){if((S=I[R+1])&&S.tag==">"){S.indent=I[R].text.toString()}I.splice(R,1)}}}else{if(!Q){I.push({tag:"\n"})}}E=false;J=I.length}function D(U,R){var T="="+L,Q=U.indexOf(T,R),S=q(U.substring(U.indexOf("=",R)+1,Q)).split(" ");G=S[0];L=S[S.length-1];return Q+T.length-1}if(A){A=A.split(" ");G=A[0];L=A[1]}for(M=0;M<N;M++){if(y==x){if(v(G,F,M)){--M;K();y=C}else{if(F.charAt(M)=="\n"){H(E)}else{O+=F.charAt(M)}}}else{if(y==C){M+=G.length-1;P=n.tags[F.charAt(M+1)];B=P?F.charAt(M+1):"_v";if(B=="="){M=D(F,M);y=x}else{if(P){M++}y=w}E=M}else{if(v(L,F,M)){I.push({tag:B,n:q(O),otag:G,ctag:L,i:(B=="/")?E-G.length:M+L.length});O="";M+=L.length-1;y=x;if(B=="{"){if(L=="}}"){M++}else{r(I[I.length-1])}}}else{O+=F.charAt(M)}}}}H(E,true);return I};function r(w){if(w.n.substr(w.n.length-1)==="}"){w.n=w.n.substring(0,w.n.length-1)}}function q(w){if(w.trim){return w.trim()}return w.replace(/^\s*|\s*$/g,"")}function v(w,A,y){if(A.charAt(y)!=w.charAt(0)){return false}for(var z=1,x=w.length;z<x;z++){if(A.charAt(y+z)!=w.charAt(z)){return false}}return true}var f={_t:true,"\n":true,"$":true,"/":true};function a(D,A,x,C){var w=[],B=null,y=null,z=null;y=x[x.length-1];while(D.length>0){z=D.shift();if(y&&y.tag=="<"&&!(z.tag in f)){throw new Error("Illegal content in < super tag.")}if(n.tags[z.tag]<=n.tags["$"]||c(z,C)){x.push(z);z.nodes=a(D,z.tag,x,C)}else{if(z.tag=="/"){if(x.length===0){throw new Error("Closing tag without opener: /"+z.n)}B=x.pop();if(z.n!=B.n&&!h(z.n,B.n,C)){throw new Error("Nesting error: "+B.n+" vs. "+z.n)}B.end=z.i;return w}else{if(z.tag=="\n"){z.last=(D.length==0)||(D[0].tag=="\n")}}}w.push(z)}if(x.length>0){throw new Error("missing closing tag: "+x.pop().n)}return w}function c(z,x){for(var y=0,w=x.length;y<w;y++){if(x[y].o==z.n){z.tag="#";return true}}}function h(A,y,x){for(var z=0,w=x.length;z<w;z++){if(x[z].c==A&&x[z].o==y){return true}}}function g(y){var w=[];for(var x in y){w.push('"'+u(x)+'": function(c,p,t,i) {'+y[x]+"}")}return"{ "+w.join(",")+" }"}function p(y){var x=[];for(var w in y.partials){x.push('"'+u(w)+'":{name:"'+u(y.partials[w].name)+'", '+p(y.partials[w])+"}")}return"partials: {"+x.join(",")+"}, subs: "+g(y.subs)}n.stringify=function(y,x,w){return"{code: function (c,p,i) { "+n.wrapMain(y.code)+" },"+p(y)+"}"};var d=0;n.generate=function(w,z,x){d=0;var y={code:"",subs:{},partials:{}};n.walk(w,y);if(x.asString){return this.stringify(y,z,x)}return this.makeTemplate(y,z,x)};n.wrapMain=function(w){return'var t=this;t.b(i=i||"");'+w+"return t.fl();"};n.template=n.Template;n.makeTemplate=function(z,y,w){var x=this.makePartials(z);x.code=new Function("c","p","i",this.wrapMain(z.code));return new this.template(x,y,this,w)};n.makePartials=function(y){var w,x={subs:{},partials:y.partials,name:y.name};for(w in x.partials){x.partials[w]=this.makePartials(x.partials[w])}for(w in y.subs){x.subs[w]=new Function("c","p","t","i",y.subs[w])}return x};function u(w){return w.replace(t,"\\\\").replace(j,'\\"').replace(o,"\\n").replace(k,"\\r")}function i(w){return(~w.indexOf("."))?"d":"f"}function m(y,x){var z="<"+(x.prefix||"");var w=z+y.n+d++;x.partials[w]={name:y.n,partials:{}};x.code+='t.b(t.rp("'+u(w)+'",c,p,"'+(y.indent||"")+'"));';return w}n.codegen={"#":function(x,w){w.code+="if(t.s(t."+i(x.n)+'("'+u(x.n)+'",c,p,1),c,p,0,'+x.i+","+x.end+',"'+x.otag+" "+x.ctag+'")){t.rs(c,p,function(c,p,t){';n.walk(x.nodes,w);w.code+="});c.pop();}"},"^":function(x,w){w.code+="if(!t.s(t."+i(x.n)+'("'+u(x.n)+'",c,p,1),c,p,1,0,0,"")){';n.walk(x.nodes,w);w.code+="};"},">":m,"<":function(z,x){var w={partials:{},code:"",subs:{},inPartial:true};n.walk(z.nodes,w);var y=x.partials[m(z,x)];y.subs=w.subs;y.partials=w.partials},"$":function(y,x){var w={subs:{},code:"",partials:x.partials,prefix:y.n};n.walk(y.nodes,w);x.subs[y.n]=w.code;if(!x.inPartial){x.code+='t.sub("'+u(y.n)+'",c,p,i);'}},"\n":function(x,w){w.code+=s('"\\n"'+(x.last?"":" + i"))},_v:function(x,w){w.code+="t.b(t.v(t."+i(x.n)+'("'+u(x.n)+'",c,p,0)));'},_t:function(x,w){w.code+=s('"'+u(x.text)+'"')},"{":b,"&":b};function b(x,w){w.code+="t.b(t.t(t."+i(x.n)+'("'+u(x.n)+'",c,p,0)));'}function s(w){return"t.b("+w+");"}n.walk=function(A,y){var z;for(var x=0,w=A.length;x<w;x++){z=n.codegen[A[x].tag];z&&z(A[x],y)}return y};n.parse=function(x,y,w){w=w||{};return a(x,"",[],w.sectionTags||[])};n.cache={};n.cacheKey=function(x,w){return[x,!!w.asString,!!w.disableLambda,w.delimiters,!!w.modelGet].join("||")};n.compile=function(z,w){w=w||{};var x=n.cacheKey(z,w);var y=this.cache[x];if(y){return y}y=this.generate(this.parse(this.scan(z,w.delimiters),z,w),z,w);return this.cache[x]=y}})(typeof exports!=="undefined"?exports:Hogan);