tinymce.PluginManager.add("tabfocus",function(d){function g(h){9===h.keyCode&&h.preventDefault()}function b(m){function i(s){function p(n){return"BODY"===n.nodeName||"hidden"!=n.type&&"none"!=n.style.display&&"hidden"!=n.style.visibility&&p(n.parentNode)}function q(n){return n.tabIndex||"INPUT"==n.nodeName||"TEXTAREA"==n.nodeName}function o(n){return !q(n)&&"-1"!=n.getAttribute("tabindex")&&p(n)}if(k=a.select(":input:enabled,*[tabindex]:not(iframe)"),f(k,function(u,r){return u.id==d.id?(h=r,!1):void 0}),s>0){for(l=h+1;l<k.length;l++){if(o(k[l])){return k[l]}}}else{for(l=h-1;l>=0;l--){if(o(k[l])){return k[l]}}}return null}var h,k,e,l;if(9===m.keyCode&&(e=c(d.getParam("tab_focus",d.getParam("tabfocus_elements",":prev,:next"))),1==e.length&&(e[1]=e[0],e[0]=":prev"),k=m.shiftKey?":prev"==e[0]?i(-1):a.get(e[0]):":next"==e[1]?i(1):a.get(e[1]))){var j=tinymce.get(k.id||k.name);k.id&&j?j.focus():window.setTimeout(function(){tinymce.Env.webkit||window.focus(),k.focus()},10),m.preventDefault()}}var a=tinymce.DOM,f=tinymce.each,c=tinymce.explode;d.on("init",function(){d.inline&&tinymce.DOM.setAttrib(d.getBody(),"tabIndex",null)}),d.on("keyup",g),tinymce.Env.gecko?d.on("keypress keydown",b):d.on("keydown",b)});