!function(J,w){function C(d,b){for(var f,c=[],a=0;a<d.length;++a){if(f=x[d[a]]||B(d[a]),!f){throw"module definition dependecy not found: "+d[a]}c.push(f)}b.apply(null,c)}function z(c,b,a){if("string"!=typeof c){throw"invalid module definition, module id must be defined and be a string"}if(b===w){throw"invalid module definition, dependencies must be specified"}if(a===w){throw"invalid module definition, definition function must be specified"}C(b,function(){x[c]=a.apply(null,arguments)})}function F(a){return !!x[a]}function B(b){for(var d=J,c=b.split(/[.\/]/),a=0;a<c.length;++a){if(!d[c[a]]){return}d=d[c[a]]}return d}function N(g){for(var e=0;e<g.length;e++){for(var d=J,f=g[e],c=f.split(/[.\/]/),b=0;b<c.length-1;++b){d[c[b]]===w&&(d[c[b]]={}),d=d[c[b]]}d[c[c.length-1]]=x[f]}}var x={},E="tinymce/pasteplugin/Clipboard",L="tinymce/Env",q="tinymce/util/Tools",K="tinymce/util/VK",I="tinymce/pasteplugin/WordFilter",A="tinymce/html/DomParser",D="tinymce/html/Schema",G="tinymce/html/Serializer",H="tinymce/html/Node",k="tinymce/pasteplugin/Quirks",j="tinymce/pasteplugin/Plugin",M="tinymce/PluginManager";z(E,[L,q,K],function(c,a,d){function b(){return !c.gecko&&("ClipboardEvent" in window||c.webkit&&"FocusEvent" in window)}return function(v){function n(){return(new Date).getTime()}function S(f){return d.metaKeyPressed(f)&&86==f.keyCode||f.shiftKey&&45==f.keyCode}function U(f){return f.innerText||f.textContent}function t(){return n()-y<100||"text"==r.pasteFormat}function R(f,g){return a.each(g,function(h){f=h.constructor==RegExp?f.replace(h,""):f.replace(h[0],h[1])}),f}function T(f){var g=v.fire("PastePreProcess",{content:f});f=g.content,v.settings.paste_data_images||(f=f.replace(/<img src=\"data:image[^>]+>/g,"")),(v.settings.paste_remove_styles||v.settings.paste_remove_styles_if_webkit!==!1&&c.webkit)&&(f=f.replace(/ style=\"[^\"]+\"/g,"")),g.isDefaultPrevented()||v.insertContent(f)}function Q(g){g=v.dom.encode(g).replace(/\r\n/g,"\n");var f=v.dom.getParent(v.selection.getStart(),v.dom.isBlock);g=f&&/^(PRE|DIV)$/.test(f.nodeName)||!v.settings.forced_root_block?R(g,[[/\n/g,"<br>"]]):R(g,[[/\n\n/g,"</p><p>"],[/^(.*<\/p>)(<p>)$/,"<p>$1"],[/\n/g,"<br />"]]);var h=v.fire("PastePreProcess",{content:g});h.isDefaultPrevented()||v.insertContent(h.content)}function P(){var g=v.dom.getViewPort().y,f=v.dom.add(v.getBody(),"div",{contentEditable:!1,"data-mce-bogus":"1",style:"position: absolute; top: "+g+"px; left: 0; width: 1px; height: 1px; overflow: hidden"},'<div contentEditable="true" data-mce-bogus="1">X</div>');return v.dom.bind(f,"beforedeactivate focusin focusout",function(h){h.stopPropagation()}),f}function e(f){v.dom.unbind(f),v.dom.remove(f)}var r=this,y;if(v.on("keydown",function(f){d.metaKeyPressed(f)&&f.shiftKey&&86==f.keyCode&&(y=n())}),b()){v.on("paste",function(g){function f(m,i){for(var l=0;l<h.types.length;l++){if(h.types[l]==m){return i(h.getData(m)),!0}}}var h=g.clipboardData;h&&(g.preventDefault(),t()?f("text/plain",Q)||f("text/html",T):f("text/html",T)||f("text/plain",Q))})}else{if(c.ie){var O=0;v.on("keydown",function(g){if(S(g)&&!g.isDefaultPrevented()){g.stopImmediatePropagation();var f=P();O=n(),v.dom.bind(f,"paste",function(){setTimeout(function(){v.selection.setRng(h),e(f),t()?Q(U(f.firstChild)):T(f.firstChild.innerHTML)},0)});var h=v.selection.getRng();f.firstChild.focus(),f.firstChild.innerText=""}}),v.on("init",function(){var f=v.dom;v.dom.bind(v.getBody(),"paste",function(h){if(n()-O>100){var m,i=P();h.preventDefault(),f.bind(i,"paste",function(o){o.stopPropagation(),m=!0});var g=v.selection.getRng(),l=f.doc.body.createTextRange();if(l.moveToElementText(i.firstChild),l.execCommand("Paste"),e(i),!m){return v.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."),void 0}v.selection.setRng(g),t()?Q(U(i.firstChild)):T(i.firstChild.innerHTML)}})})}else{v.on("init",function(){v.dom.bind(v.getBody(),"paste",function(f){f.preventDefault(),v.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents.")})}),v.on("keydown",function(g){if(S(g)&&!g.isDefaultPrevented()){g.stopImmediatePropagation();var f=P(),h=v.selection.getRng();v.selection.select(f,!0),v.dom.bind(f,"paste",function(i){i.stopPropagation(),setTimeout(function(){e(f),v.lastRng=h,v.selection.setRng(h);var l=f.firstChild;l.lastChild&&"BR"==l.lastChild.nodeName&&l.removeChild(l.lastChild),t()?Q(U(l)):T(l.innerHTML)},0)})}})}v.settings.paste_data_images||v.on("drop",function(g){var f=g.dataTransfer;f&&f.files&&f.files.length>0&&g.preventDefault()})}v.paste_block_drop&&v.on("dragend dragover draggesture dragdrop drop drag",function(f){f.preventDefault(),f.stopPropagation()}),this.paste=T,this.pasteText=Q}}),z(I,[q,A,D,G,H],function(d,b,f,c,a){return function(g){var e=d.each;g.on("PastePreProcess",function(Q){function o(h){e(h,function(l){y=l.constructor==RegExp?y.replace(l,""):y.replace(l[0],l[1])})}function O(S){function X(ac,aa,Z,ab){var u=ac._listLevel||m;u!=m&&(m>u?p&&(p=p.parent.parent):(h=p,p=null)),p&&p.name==Z?p.append(ac):(h=h||p,p=new a(Z,1),ab>1&&p.attr("start",""+ab),ac.wrap(p)),ac.name="li",aa.value="";var ad=aa.next;ad&&3==ad.type&&(ad.value=ad.value.replace(/^\u00a0+/,"")),u>m&&h&&h.lastChild.append(p),m=u}for(var p,h,m=1,V=S.getAll("p"),Y=0;Y<V.length;Y++){if(S=V[Y],"p"==S.name&&S.firstChild){for(var R="",U=S.firstChild;U&&!(R=U.value);){U=U.firstChild}if(/^\s*[\u2022\u00b7\u00a7\u00d8o\u25CF]\s*$/.test(R)){X(S,U,"ul");continue}if(/^\s*\w+\./.test(R)){var W=/([0-9])\./.exec(R),T=1;W&&(T=parseInt(W[1],10)),X(S,U,"ol",T);continue}p=null}}}function P(l,p){if("p"===l.name){var m=/mso-list:\w+ \w+([0-9]+)/.exec(p);m&&(l._listLevel=parseInt(m[1],10))}if(g.getParam("paste_retain_style_properties","none")){var h="";if(d.each(g.dom.parseStyle(p),function(u,s){switch(s){case"horiz-align":return s="text-align",void 0;case"vert-align":return s="vertical-align",void 0;case"font-color":case"mso-foreground":return s="color",void 0;case"mso-background":case"mso-highlight":s="background"}("all"==v||i&&i[s])&&(h+=s+":"+u+";")}),h){return h}}return null}var y=Q.content,v,i;if(v=g.settings.paste_retain_style_properties,v&&(i=d.makeMap(v)),g.settings.paste_enable_default_filters!==!1&&/class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(Q.content)){Q.wordContent=!0,o([/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,"\xa0"],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(l,h){return h.length>0?h.replace(/./," ").slice(Math.floor(h.length/2)).split("").join("\xa0"):""}]]);var n=new f({valid_elements:"@[style],-strong/b,-em/i,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-table,-tr,-td[colspan|rowspan],-th,-thead,-tfoot,-tbody,-a[!href],sub,sup,strike"}),r=new b({},n);r.addAttributeFilter("style",function(l){for(var h=l.length,m;h--;){m=l[h],m.attr("style",P(m,m.attr("style"))),"span"!=m.name||m.attributes.length||m.unwrap()}});var t=r.parse(y);O(t),Q.content=new c({},n).serialize(t)}})}}),z(k,[L,q],function(b,a){return function(h){function f(i){h.on("PastePreProcess",function(l){l.content=i(l.content)})}function d(i,l){return a.each(l,function(m){i=m.constructor==RegExp?i.replace(m,""):i.replace(m[0],m[1])}),i}function g(i){return i=d(i,[/^[\s\S]*<!--StartFragment-->|<!--EndFragment-->[\s\S]*$/g,[/<span class="Apple-converted-space">\u00a0<\/span>/g,"\xa0"],/<br>$/])}function c(l){if(!e){var i=[];a.each(h.schema.getBlockElements(),function(n,m){i.push(m)}),e=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+i.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g")}return l=d(l,[[e,"$1"]]),l=d(l,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}var e;b.webkit&&f(g),b.ie&&f(c)}}),z(j,[M,E,I,k],function(d,b,f,c){var a;d.add("paste",function(i){function l(){"text"==h.pasteFormat?(this.active(!1),h.pasteFormat="html"):(h.pasteFormat="text",this.active(!0),a||(i.windowManager.alert("Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off."),a=!0))}var g=this,h;g.clipboard=h=new b(i),g.quirks=new c(i),g.wordFilter=new f(i),i.settings.paste_as_text&&(g.clipboard.pasteFormat="text"),i.addCommand("mceInsertClipboardContent",function(n,m){m.content&&g.clipboard.paste(m.content),m.text&&g.clipboard.pasteText(m.text)}),i.addButton("pastetext",{icon:"pastetext",tooltip:"Paste as text",onclick:l,active:"text"==g.clipboard.pasteFormat}),i.addMenuItem("pastetext",{text:"Paste as text",selectable:!0,active:h.pasteFormat,onclick:l})})}),N([E,I,k,j])}(this);