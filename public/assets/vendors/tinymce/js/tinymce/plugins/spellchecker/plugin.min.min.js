!function(z,E){function k(d,a){for(var h,c=[],f=0;f<d.length;++f){if(h=F[d[f]]||w(d[f]),!h){throw"module definition dependecy not found: "+d[f]}c.push(h)}a.apply(null,c)}function b(c,a,d){if("string"!=typeof c){throw"invalid module definition, module id must be defined and be a string"}if(a===E){throw"invalid module definition, dependencies must be specified"}if(d===E){throw"invalid module definition, definition function must be specified"}k(a,function(){F[c]=d.apply(null,arguments)})}function j(a){return !!F[a]}function w(a){for(var e=z,c=a.split(/[.\/]/),d=0;d<c.length;++d){if(!e[c[d]]){return}e=e[c[d]]}return e}function C(m){for(var f=0;f<m.length;f++){for(var h=z,e=m[f],d=e.split(/[.\/]/),c=0;c<d.length-1;++c){h[d[c]]===E&&(h[d[c]]={}),h=h[d[c]]}h[d[d.length-1]]=F[e]}}var F={},v="tinymce/spellcheckerplugin/DomTextMatcher",B="tinymce/spellcheckerplugin/Plugin",A="tinymce/PluginManager",D="tinymce/util/Tools",y="tinymce/ui/Menu",g="tinymce/dom/DOMUtils",q="tinymce/util/JSONRequest",x="tinymce/util/URI";b(v,[],function(){return function(U,I,N){function K(c){if(!c[0]){throw"findAndReplaceDOMText cannot handle zero-length matches"}var a=c.index;return[a,a+c[0].length,[c[0]]]}function M(c){var a;if(3===c.nodeType){return c.data}if(S[c.nodeName]){return""}if(a="",(R[c.nodeName]||G[c.nodeName])&&(a+="\n"),c=c.firstChild){do{a+=M(c)}while(c=c.nextSibling)}return a}function Q(Z,ae,m){var f,h,Y,ac,af=[],p=0,ab=Z,aa=ae.shift(),ad=0;Z:for(;;){if((R[ab.nodeName]||G[ab.nodeName])&&p++,3===ab.nodeType&&(!h&&ab.length+p>=aa[1]?(h=ab,ac=aa[1]-p):f&&af.push(ab),!f&&ab.length+p>aa[0]&&(f=ab,Y=aa[0]-p),p+=ab.length),f&&h){if(ab=m({startNode:f,startNodeIndex:Y,endNode:h,endNodeIndex:ac,innerNodes:af,match:aa[2],matchIndex:ad}),p-=h.length-ac,f=null,h=null,af=[],aa=ae.shift(),ad++,!aa){break}}else{if(!S[ab.nodeName]&&ab.firstChild){ab=ab.firstChild;continue}if(ab.nextSibling){ab=ab.nextSibling;continue}}for(;;){if(ab.nextSibling){ab=ab.nextSibling;break}if(ab.parentNode===Z){break Z}ab=ab.parentNode}}}function X(d){var a;if("function"!=typeof d){var f=d.nodeType?d:O.createElement(d);a=function(l,h){var i=f.cloneNode(!1);return i.setAttribute("data-mce-index",h),l&&i.appendChild(O.createTextNode(l)),i}}else{a=d}return function c(af){var Z,m,Y,ab=af.startNode,ai=af.endNode,al=af.matchIndex;if(ab===ai){var aa=ab;Y=aa.parentNode,af.startNodeIndex>0&&(Z=O.createTextNode(aa.data.substring(0,af.startNodeIndex)),Y.insertBefore(Z,aa));var ah=a(af.match[0],al);return Y.insertBefore(ah,aa),af.endNodeIndex<aa.length&&(m=O.createTextNode(aa.data.substring(af.endNodeIndex)),Y.insertBefore(m,aa)),aa.parentNode.removeChild(aa),ah}Z=O.createTextNode(ab.data.substring(0,af.startNodeIndex)),m=O.createTextNode(ai.data.substring(af.endNodeIndex));for(var ag=a(ab.data.substring(af.startNodeIndex),al),ak=[],ae=0,t=af.innerNodes.length;t>ae;++ae){var ac=af.innerNodes[ae],ad=a(ac.data,al);ac.parentNode.replaceChild(ad,ac),ak.push(ad)}var aj=a(ai.data.substring(0,af.endNodeIndex),al);return Y=ab.parentNode,Y.insertBefore(Z,ab),Y.insertBefore(ag,ab),Y.removeChild(ab),Y=ai.parentNode,Y.insertBefore(aj,ai),Y.insertBefore(m,ai),Y.removeChild(ai),aj}}function J(c){var a=[];return P(function(e,d){c(e,d)&&a.push(e)}),H=a,this}function P(c){for(var a=0,d=H.length;d>a&&c(H[a],a)!==!1;a++){}return this}function W(a){return H.length&&(L=H.length,Q(I,H,X(a))),this}var V,H=[],T,L=0,O,R,S,G;if(O=I.ownerDocument,R=N.getBlockElements(),S=N.getWhiteSpaceElements(),G=N.getShortEndedElements(),T=M(I),T&&U.global){for(;V=U.exec(T);){H.push(K(V))}}return{text:T,count:L,matches:H,each:P,filter:J,mark:W}}}),b(B,[v,A,D,y,g,q,x],function(l,f,p,h,m,d,c){f.add("spellchecker",function(M,N){function i(u){for(var s in u){return !1}return !0}function H(Q,O){var u=[],P=o[O];p.each(P,function(s){u.push({text:s,onclick:function(){M.insertContent(s),L()}})}),u.push.apply(u,[{text:"-"},{text:"Ignore",onclick:function(){a(Q,O)}},{text:"Ignore all",onclick:function(){a(Q,O,!0)}},{text:"Finish",onclick:e}]),J=new h({items:u,context:"contextmenu",onautohide:function(s){-1!=s.target.className.indexOf("spellchecker")&&s.preventDefault()},onhide:function(){J.remove(),J=null}}),J.renderTo(document.body);var t=m.DOM.getPos(M.getContentAreaContainer()),R=M.dom.getPos(Q);t.x+=R.x,t.y+=R.y,J.moveTo(t.x,t.y+Q.offsetHeight)}function G(){function S(u){return M.setProgressState(!1),i(u)?(M.windowManager.alert("No misspellings found"),K=!1,void 0):(o=u,Q.filter(function(T){return !!u[T[2][0]]}).mark(M.dom.create("span",{"class":"mce-spellchecker-word","data-mce-bogus":1})),Q=null,M.fire("SpellcheckStart"),void 0)}function t(T,U,u){d.sendRPC({url:new c(N).toAbsolute(I.spellchecker_rpc_url),method:T,params:{lang:I.spellchecker_language||"en",words:U},success:function(V){u(V)},error:function(V,W){V="JSON Parse error."==V?"Non JSON response:"+W.responseText:"Error: "+V,M.windowManager.alert(V),M.setProgressState(!1),Q=null,K=!1}})}var Q,R=[],P={};if(K){return e(),void 0}K=!0;var s=M.getParam("spellchecker_wordchar_pattern")||new RegExp('[^\\s!"#$%&()*+,-./:;<=>?@[\\]^_{|}`\xa7\xa9\xab\xae\xb1\xb6\xb7\xb8\xbb\xbc\xbd\xbe\xbf\xd7\xf7\xa4\u201d\u201c\u201e]+',"g");Q=new l(s,M.getBody(),M.schema).each(function(T){var u=T[2][0];if(!P[u]){if(/^\d+$/.test(u)||1==u.length){return}R.push(u),P[u]=!0}}),M.setProgressState(!0);var O=I.spellchecker_callback||t;O("spellcheck",R,S)}function L(){M.dom.select("span.mce-spellchecker-word").length||e()}function r(u){var s=u.parentNode;s.insertBefore(u.firstChild,u),u.parentNode.removeChild(u)}function a(t,s,u){u?p.each(M.dom.select("span.mce-spellchecker-word"),function(P){var O=P.innerText||P.textContent;O==s&&r(P)}):r(t),L()}function e(){var t,u,s;for(K=!1,s=M.getBody(),u=s.getElementsByTagName("span"),t=u.length;t--;){s=u[t],s.getAttribute("data-mce-index")&&r(s)}M.fire("SpellcheckEnd")}function n(R){var T,Q,S,O=-1,u,P;for(R=""+R,T=M.getBody().getElementsByTagName("span"),Q=0;Q<T.length&&(S=T[Q],"mce-spellchecker-word"!=S.className||(O=S.getAttribute("data-mce-index"),O===R&&(O=R,u||(u=S.firstChild),P=S.firstChild),O===R||!P));Q++){}var t=M.dom.createRng();return t.setStart(u,0),t.setEnd(P,P.length),M.selection.setRng(t),t}var o,K,J,I=M.settings;M.on("click",function(u){if("mce-spellchecker-word"==u.target.className){u.preventDefault();var s=n(u.target.getAttribute("data-mce-index"));H(u.target,s.toString())}}),M.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:G,selectable:!0,onPostRender:function(){var s=this;M.on("SpellcheckStart SpellcheckEnd",function(){s.active(K)})}}),M.addButton("spellchecker",{tooltip:"Spellcheck",onclick:G,onPostRender:function(){var s=this;M.on("SpellcheckStart SpellcheckEnd",function(){s.active(K)})}}),M.on("remove",function(){J&&(J.remove(),J=null)})})}),C([v,B])}(this);