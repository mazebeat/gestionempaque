tinymce.PluginManager.add("visualblocks",function(g,d){function h(){var a=this;a.active(f),g.on("VisualBlocks",function(){a.active(g.dom.hasClass(g.getBody(),"mce-visualblocks"))})}var c,b,f;window.NodeList&&(g.addCommand("mceVisualBlocks",function(){var e,a=g.dom;c||(c=a.uniqueId(),e=a.create("link",{id:c,rel:"stylesheet",href:d+"/css/visualblocks.css"}),g.getDoc().getElementsByTagName("head")[0].appendChild(e)),g.on("PreviewFormats AfterPreviewFormats",function(i){f&&a.toggleClass(g.getBody(),"mce-visualblocks","afterpreviewformats"==i.type)}),a.toggleClass(g.getBody(),"mce-visualblocks"),f=g.dom.hasClass(g.getBody(),"mce-visualblocks"),b&&b.active(a.hasClass(g.getBody(),"mce-visualblocks")),g.fire("VisualBlocks")}),g.addButton("visualblocks",{title:"Show blocks",cmd:"mceVisualBlocks",onPostRender:h}),g.addMenuItem("visualblocks",{text:"Show blocks",cmd:"mceVisualBlocks",onPostRender:h,selectable:!0,context:"view",prependToContext:!0}),g.on("init",function(){g.settings.visualblocks_default_state&&g.execCommand("mceVisualBlocks",!1,null,{skip_focus:!0})}),g.on("remove",function(){g.dom.removeClass(g.getBody(),"mce-visualblocks")}))});