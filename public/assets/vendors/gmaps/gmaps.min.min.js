/*!
 * GMaps.js v0.4.12
 * http://hpneo.github.com/gmaps/
 *
 * Copyright 2012, Gustavo Leon
 * Released under the MIT License.
 */
!function(b,a){"object"==typeof exports?module.exports=a():"function"==typeof define&&define.amd&&define("GMaps",[],a),b.GMaps=a()}(this,function(){if("object"!=typeof window.google||!window.google.maps){throw"Google Maps API is required. Please register the following JavaScript library http://maps.google.com/maps/api/js?sensor=true."}var q=function(g,a){var i;if(g===a){return g}for(i in a){g[i]=a[i]}return g},d=function(l,a){var p,v=Array.prototype.slice.call(arguments,2),i=[],g=l.length;if(Array.prototype.map&&l.map===Array.prototype.map){i=Array.prototype.map.call(l,function(n){return callback_params=v,callback_params.splice(0,0,n),a.apply(this,callback_params)})}else{for(p=0;g>p;p++){callback_params=v,callback_params.splice(0,0,l[p]),i.push(a.apply(this,callback_params))}}return i},f=function(g){var a,i=[];for(a=0;a<g.length;a++){i=i.concat(g[a])}return i},b=function(g,a){var i=g[0],l=g[1];return a&&(i=g[1],l=g[0]),new google.maps.LatLng(i,l)},u=function(g,a){var i;for(i=0;i<g.length;i++){g[i]=g[i].length>0&&"object"==typeof g[i][0]?u(g[i],a):b(g[i],a)}return g},j=function(g,a){var i,g=g.replace("#","");return i="jQuery" in this&&a?$("#"+g,a)[0]:document.getElementById(g)},m=function(g){var a=0,i=0;if(g.offsetParent){do{a+=g.offsetLeft,i+=g.offsetTop}while(g=g.offsetParent)}return[a,i]},h=function(){var a=document,g=function(V){if(!this){return new g(V)}V.zoom=V.zoom||15,V.mapType=V.mapType||"roadmap";var R,N=this,Y=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","idle","maptypeid_changed","projection_changed","resize","tilesloaded","zoom_changed"],U=["mousemove","mouseout","mouseover"],ab=["el","lat","lng","mapType","width","height","markerClusterer","enableNewStyle"],ae=V.el||V.div,aa=V.markerClusterer,K=google.maps.MapTypeId[V.mapType.toUpperCase()],ad=new google.maps.LatLng(V.lat,V.lng),ac=V.zoomControl||!0,X=V.zoomControlOpt||{style:"DEFAULT",position:"TOP_LEFT"},G=X.style||"DEFAULT",J=X.position||"TOP_LEFT",Z=V.panControl||!0,I=V.mapTypeControl||!0,af=V.scaleControl||!0,E=V.streetViewControl||!0,ag=ag||!0,H={},D={zoom:this.zoom,center:ad,mapTypeId:K},A={panControl:Z,zoomControl:ac,zoomControlOptions:{style:google.maps.ZoomControlStyle[G],position:google.maps.ControlPosition[J]},mapTypeControl:I,scaleControl:af,streetViewControl:E,overviewMapControl:ag};if(this.el="string"==typeof V.el||"string"==typeof V.div?j(ae,V.context):ae,"undefined"==typeof this.el||null===this.el){throw"No element defined."}for(window.context_menu=window.context_menu||{},window.context_menu[N.el.id]={},this.controls=[],this.overlays=[],this.layers=[],this.singleLayers={},this.markers=[],this.polylines=[],this.routes=[],this.polygons=[],this.infoWindow=null,this.overlay_el=null,this.zoom=V.zoom,this.registered_events={},this.el.style.width=V.width||this.el.scrollWidth||this.el.offsetWidth,this.el.style.height=V.height||this.el.scrollHeight||this.el.offsetHeight,google.maps.visualRefresh=V.enableNewStyle,R=0;R<ab.length;R++){delete V[ab[R]]}for(1!=V.disableDefaultUI&&(D=q(D,A)),H=q(D,V),R=0;R<Y.length;R++){delete H[Y[R]]}for(R=0;R<U.length;R++){delete H[U[R]]}this.map=new google.maps.Map(this.el,H),aa&&(this.markerClusterer=aa.apply(this,[this.map]));var B=function(O,W){var w="",x=window.context_menu[N.el.id][O];for(var s in x){if(x.hasOwnProperty(s)){var z=x[s];w+='<li><a id="'+O+"_"+s+'" href="#">'+z.title+"</a></li>"}}if(j("gmaps_context_menu")){var v=j("gmaps_context_menu");v.innerHTML=w;var s,L=v.getElementsByTagName("a"),S=L.length;for(s=0;S>s;s++){var C=L[s],T=function(l){l.preventDefault(),x[this.id.replace(O+"_","")].action.apply(N,[W]),N.hideContextMenu()};google.maps.event.clearListeners(C,"click"),google.maps.event.addDomListenerOnce(C,"click",T,!1)}var P=m.apply(this,[N.el]),M=P[0]+W.pixel.x-15,y=P[1]+W.pixel.y-15;v.style.left=M+"px",v.style.top=y+"px",v.style.display="block"}};this.buildContextMenu=function(n,l){if("marker"===n){l.pixel={};var p=new google.maps.OverlayView;p.setMap(N.map),p.draw=function(){var v=p.getProjection(),s=l.marker.getPosition();l.pixel=v.fromLatLngToContainerPixel(s),B(n,l)}}else{B(n,l)}},this.setContextMenu=function(p){window.context_menu[N.el.id][p.control]={};var v,w=a.createElement("ul");for(v in p.options){if(p.options.hasOwnProperty(v)){var s=p.options[v];window.context_menu[N.el.id][p.control][s.name]={title:s.title,action:s.action}}}w.id="gmaps_context_menu",w.style.display="none",w.style.position="absolute",w.style.minWidth="100px",w.style.background="white",w.style.listStyle="none",w.style.padding="8px",w.style.boxShadow="2px 2px 6px #ccc",a.body.appendChild(w);var l=j("gmaps_context_menu");google.maps.event.addDomListener(l,"mouseout",function(n){n.relatedTarget&&this.contains(n.relatedTarget)||window.setTimeout(function(){l.style.display="none"},400)},!1)},this.hideContextMenu=function(){var l=j("gmaps_context_menu");l&&(l.style.display="none")};for(var Q=function(n,l){google.maps.event.addListener(n,l,function(p){void 0==p&&(p=this),V[l].apply(this,[p]),N.hideContextMenu()})},o=0;o<Y.length;o++){var F=Y[o];F in V&&Q(this.map,F)}for(var o=0;o<U.length;o++){var F=U[o];F in V&&Q(this.map,F)}google.maps.event.addListener(this.map,"rightclick",function(l){V.rightclick&&V.rightclick.apply(this,[l]),void 0!=window.context_menu[N.el.id].map&&N.buildContextMenu("map",l)}),this.refresh=function(){google.maps.event.trigger(this.map,"resize")},this.fitZoom=function(){var n,l=[],p=this.markers.length;for(n=0;p>n;n++){"boolean"==typeof this.markers[n].visible&&this.markers[n].visible&&l.push(this.markers[n].getPosition())}this.fitLatLngBounds(l)},this.fitLatLngBounds=function(p){for(var l=p.length,r=new google.maps.LatLngBounds,s=0;l>s;s++){r.extend(p[s])}this.map.fitBounds(r)},this.setCenter=function(n,l,p){this.map.panTo(new google.maps.LatLng(n,l)),p&&p()},this.getElement=function(){return this.el},this.zoomIn=function(l){l=l||1,this.zoom=this.map.getZoom()+l,this.map.setZoom(this.zoom)},this.zoomOut=function(l){l=l||1,this.zoom=this.map.getZoom()-l,this.map.setZoom(this.zoom)};var t,i=[];for(t in this.map){"function"!=typeof this.map[t]||this[t]||i.push(t)}for(R=0;R<i.length;R++){!function(n,l,p){n[p]=function(){return l[p].apply(l,arguments)}}(this,this.map,i[R])}};return g}(this);h.prototype.createControl=function(g){var a=document.createElement("div");a.style.cursor="pointer",g.disableDefaultStyles!==!0&&(a.style.fontFamily="Roboto, Arial, sans-serif",a.style.fontSize="11px",a.style.boxShadow="rgba(0, 0, 0, 0.298039) 0px 1px 4px -1px");for(var i in g.style){a.style[i]=g.style[i]}g.id&&(a.id=g.id),g.classes&&(a.className=g.classes),g.content&&(a.innerHTML=g.content);for(var l in g.events){!function(n,p){google.maps.event.addDomListener(n,p,function(){g.events[p].apply(this,[this])})}(a,l)}return a.index=1,a},h.prototype.addControl=function(g){var a=google.maps.ControlPosition[g.position.toUpperCase()];delete g.position;var i=this.createControl(g);return this.controls.push(i),this.map.controls[a].push(i),i},h.prototype.createMarker=function(C){if(void 0==C.lat&&void 0==C.lng&&void 0==C.position){throw"No latitude or longitude defined."}var w=this,x=C.details,t=C.fences,F=C.outside,z={position:new google.maps.LatLng(C.lat,C.lng),map:null},E=q(z,C);delete E.lat,delete E.lng,delete E.fences,delete E.outside;var y=new google.maps.Marker(E);if(y.fences=t,C.infoWindow){y.infoWindow=new google.maps.InfoWindow(C.infoWindow);for(var v=["closeclick","content_changed","domready","position_changed","zindex_changed"],B=0;B<v.length;B++){!function(a,g){C.infoWindow[g]&&google.maps.event.addListener(a,g,function(i){C.infoWindow[g].apply(this,[i])})}(y.infoWindow,v[B])}}for(var D=["animation_changed","clickable_changed","cursor_changed","draggable_changed","flat_changed","icon_changed","position_changed","shadow_changed","shape_changed","title_changed","visible_changed","zindex_changed"],A=["dblclick","drag","dragend","dragstart","mousedown","mouseout","mouseover","mouseup"],B=0;B<D.length;B++){!function(a,g){C[g]&&google.maps.event.addListener(a,g,function(){C[g].apply(this,[this])})}(y,D[B])}for(var B=0;B<A.length;B++){!function(a,g,i){C[i]&&google.maps.event.addListener(g,i,function(l){l.pixel||(l.pixel=a.getProjection().fromLatLngToPoint(l.latLng)),C[i].apply(this,[l])})}(this.map,y,A[B])}return google.maps.event.addListener(y,"click",function(){this.details=x,C.click&&C.click.apply(this,[this]),y.infoWindow&&(w.hideInfoWindows(),y.infoWindow.open(w.map,y))}),google.maps.event.addListener(y,"rightclick",function(a){a.marker=this,C.rightclick&&C.rightclick.apply(this,[a]),void 0!=window.context_menu[w.el.id].marker&&w.buildContextMenu("marker",a)}),y.fences&&google.maps.event.addListener(y,"dragend",function(){w.checkMarkerGeofence(y,function(g,a){F(g,a)})}),y},h.prototype.addMarker=function(g){var a;if(g.hasOwnProperty("gm_accessors_")){a=g}else{if(!(g.hasOwnProperty("lat")&&g.hasOwnProperty("lng")||g.position)){throw"No latitude or longitude defined."}a=this.createMarker(g)}return a.setMap(this.map),this.markerClusterer&&this.markerClusterer.addMarker(a),this.markers.push(a),h.fire("marker_added",a,this),a},h.prototype.addMarkers=function(g){for(var a,i=0;a=g[i];i++){this.addMarker(a)}return this.markers},h.prototype.hideInfoWindows=function(){for(var g,a=0;g=this.markers[a];a++){g.infoWindow&&g.infoWindow.close()}},h.prototype.removeMarker=function(g){for(var a=0;a<this.markers.length;a++){if(this.markers[a]===g){this.markers[a].setMap(null),this.markers.splice(a,1),this.markerClusterer&&this.markerClusterer.removeMarker(g),h.fire("marker_removed",g,this);break}}return g},h.prototype.removeMarkers=function(g){var a=[];if("undefined"==typeof g){for(var i=0;i<this.markers.length;i++){this.markers[i].setMap(null)}this.markers=a}else{for(var i=0;i<g.length;i++){this.markers.indexOf(g[i])>-1&&this.markers[i].setMap(null)}for(var i=0;i<this.markers.length;i++){null!=this.markers[i].getMap()&&a.push(this.markers[i])}this.markers=a}},h.prototype.drawOverlay=function(g){var a=new google.maps.OverlayView,i=!0;return a.setMap(this.map),null!=g.auto_show&&(i=g.auto_show),a.onAdd=function(){var v=document.createElement("div");v.style.borderStyle="none",v.style.borderWidth="0px",v.style.position="absolute",v.style.zIndex=100,v.innerHTML=g.content,a.el=v,g.layer||(g.layer="overlayLayer");var w=this.getPanes(),t=w[g.layer],p=["contextmenu","DOMMouseScroll","dblclick","mousedown"];t.appendChild(v);for(var l=0;l<p.length;l++){!function(o,n){google.maps.event.addDomListener(o,n,function(r){-1!=navigator.userAgent.toLowerCase().indexOf("msie")&&document.all?(r.cancelBubble=!0,r.returnValue=!1):r.stopPropagation()})}(v,p[l])}g.click&&google.maps.event.addDomListener(a.el,"click",function(){g.click.apply(a,[a])}),google.maps.event.trigger(this,"ready")},a.draw=function(){var x=this.getProjection(),w=x.fromLatLngToDivPixel(new google.maps.LatLng(g.lat,g.lng));g.horizontalOffset=g.horizontalOffset||0,g.verticalOffset=g.verticalOffset||0;var v=a.el,t=v.children[0],p=t.clientHeight,o=t.clientWidth;switch(g.verticalAlign){case"top":v.style.top=w.y-p+g.verticalOffset+"px";break;default:case"middle":v.style.top=w.y-p/2+g.verticalOffset+"px";break;case"bottom":v.style.top=w.y+g.verticalOffset+"px"}switch(g.horizontalAlign){case"left":v.style.left=w.x-o+g.horizontalOffset+"px";break;default:case"center":v.style.left=w.x-o/2+g.horizontalOffset+"px";break;case"right":v.style.left=w.x+g.horizontalOffset+"px"}v.style.display=i?"block":"none",i||g.show.apply(this,[v])},a.onRemove=function(){var l=a.el;g.remove?g.remove.apply(this,[l]):(a.el.parentNode.removeChild(a.el),a.el=null)},this.overlays.push(a),a},h.prototype.removeOverlay=function(g){for(var a=0;a<this.overlays.length;a++){if(this.overlays[a]===g){this.overlays[a].setMap(null),this.overlays.splice(a,1);break}}},h.prototype.removeOverlays=function(){for(var g,a=0;g=this.overlays[a];a++){g.setMap(null)}this.overlays=[]},h.prototype.drawPolyline=function(y){var A=[],v=y.path;if(v.length){if(void 0===v[0][0]){A=v}else{for(var w,g=0;w=v[g];g++){A.push(new google.maps.LatLng(w[0],w[1]))}}}var B={map:this.map,path:A,strokeColor:y.strokeColor,strokeOpacity:y.strokeOpacity,strokeWeight:y.strokeWeight,geodesic:y.geodesic,clickable:!0,editable:!1,visible:!0};y.hasOwnProperty("clickable")&&(B.clickable=y.clickable),y.hasOwnProperty("editable")&&(B.editable=y.editable),y.hasOwnProperty("icons")&&(B.icons=y.icons),y.hasOwnProperty("zIndex")&&(B.zIndex=y.zIndex);for(var x=new google.maps.Polyline(B),z=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],l=0;l<z.length;l++){!function(a,i){y[i]&&google.maps.event.addListener(a,i,function(n){y[i].apply(this,[n])})}(x,z[l])}return this.polylines.push(x),h.fire("polyline_added",x,this),x},h.prototype.removePolyline=function(g){for(var a=0;a<this.polylines.length;a++){if(this.polylines[a]===g){this.polylines[a].setMap(null),this.polylines.splice(a,1),h.fire("polyline_removed",g,this);break}}},h.prototype.removePolylines=function(){for(var g,a=0;g=this.polylines[a];a++){g.setMap(null)}this.polylines=[]},h.prototype.drawCircle=function(g){g=q({map:this.map,center:new google.maps.LatLng(g.lat,g.lng)},g),delete g.lat,delete g.lng;for(var i=new google.maps.Circle(g),l=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],a=0;a<l.length;a++){!function(n,p){g[p]&&google.maps.event.addListener(n,p,function(o){g[p].apply(this,[o])})}(i,l[a])}return this.polygons.push(i),i},h.prototype.drawRectangle=function(i){i=q({map:this.map},i);var l=new google.maps.LatLngBounds(new google.maps.LatLng(i.bounds[0][0],i.bounds[0][1]),new google.maps.LatLng(i.bounds[1][0],i.bounds[1][1]));i.bounds=l;for(var p=new google.maps.Rectangle(i),g=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],a=0;a<g.length;a++){!function(n,r){i[r]&&google.maps.event.addListener(n,r,function(o){i[r].apply(this,[o])})}(p,g[a])}return this.polygons.push(p),p},h.prototype.drawPolygon=function(s){var n=!1;s.hasOwnProperty("useGeoJSON")&&(n=s.useGeoJSON),delete s.useGeoJSON,s=q({map:this.map},s),0==n&&(s.paths=[s.paths.slice(0)]),s.paths.length>0&&s.paths[0].length>0&&(s.paths=f(d(s.paths,u,n)));for(var l=new google.maps.Polygon(s),g=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],o=0;o<g.length;o++){!function(a,i){s[i]&&google.maps.event.addListener(a,i,function(p){s[i].apply(this,[p])})}(l,g[o])}return this.polygons.push(l),h.fire("polygon_added",l,this),l},h.prototype.removePolygon=function(g){for(var a=0;a<this.polygons.length;a++){if(this.polygons[a]===g){this.polygons[a].setMap(null),this.polygons.splice(a,1),h.fire("polygon_removed",g,this);break}}},h.prototype.removePolygons=function(){for(var g,a=0;g=this.polygons[a];a++){g.setMap(null)}this.polygons=[]},h.prototype.getFromFusionTables=function(i){var a=i.events;delete i.events;var l=i,p=new google.maps.FusionTablesLayer(l);for(var g in a){!function(n,r){google.maps.event.addListener(n,r,function(o){a[r].apply(this,[o])})}(p,g)}return this.layers.push(p),p},h.prototype.loadFromFusionTables=function(g){var a=this.getFromFusionTables(g);return a.setMap(this.map),a},h.prototype.getFromKML=function(l){var a=l.url,p=l.events;delete l.url,delete l.events;var v=l,i=new google.maps.KmlLayer(a,v);for(var g in p){!function(o,n){google.maps.event.addListener(o,n,function(r){p[n].apply(this,[r])})}(i,g)}return this.layers.push(i),i},h.prototype.loadFromKML=function(g){var a=this.getFromKML(g);return a.setMap(this.map),a},h.prototype.addLayer=function(i,a){a=a||{};var l;switch(i){case"weather":this.singleLayers.weather=l=new google.maps.weather.WeatherLayer;break;case"clouds":this.singleLayers.clouds=l=new google.maps.weather.CloudLayer;break;case"traffic":this.singleLayers.traffic=l=new google.maps.TrafficLayer;break;case"transit":this.singleLayers.transit=l=new google.maps.TransitLayer;break;case"bicycling":this.singleLayers.bicycling=l=new google.maps.BicyclingLayer;break;case"panoramio":this.singleLayers.panoramio=l=new google.maps.panoramio.PanoramioLayer,l.setTag(a.filter),delete a.filter,a.click&&google.maps.event.addListener(l,"click",function(n){a.click(n),delete a.click});break;case"places":if(this.singleLayers.places=l=new google.maps.places.PlacesService(this.map),a.search||a.nearbySearch||a.radarSearch){var p={bounds:a.bounds||null,keyword:a.keyword||null,location:a.location||null,name:a.name||null,radius:a.radius||null,rankBy:a.rankBy||null,types:a.types||null};a.radarSearch&&l.radarSearch(p,a.radarSearch),a.search&&l.search(p,a.search),a.nearbySearch&&l.nearbySearch(p,a.nearbySearch)}if(a.textSearch){var g={bounds:a.bounds||null,location:a.location||null,query:a.query||null,radius:a.radius||null};l.textSearch(g,a.textSearch)}}return void 0!==l?("function"==typeof l.setOptions&&l.setOptions(a),"function"==typeof l.setMap&&l.setMap(this.map),l):void 0},h.prototype.removeLayer=function(g){if("string"==typeof g&&void 0!==this.singleLayers[g]){this.singleLayers[g].setMap(null),delete this.singleLayers[g]}else{for(var a=0;a<this.layers.length;a++){if(this.layers[a]===g){this.layers[a].setMap(null),this.layers.splice(a,1);break}}}};var c,k;return h.prototype.getRoutes=function(i){switch(i.travelMode){case"bicycling":c=google.maps.TravelMode.BICYCLING;break;case"transit":c=google.maps.TravelMode.TRANSIT;break;case"driving":c=google.maps.TravelMode.DRIVING;break;default:c=google.maps.TravelMode.WALKING}k="imperial"===i.unitSystem?google.maps.UnitSystem.IMPERIAL:google.maps.UnitSystem.METRIC;var l={avoidHighways:!1,avoidTolls:!1,optimizeWaypoints:!1,waypoints:[]},p=q(l,i);p.origin=/string/.test(typeof i.origin)?i.origin:new google.maps.LatLng(i.origin[0],i.origin[1]),p.destination=/string/.test(typeof i.destination)?i.destination:new google.maps.LatLng(i.destination[0],i.destination[1]),p.travelMode=c,p.unitSystem=k,delete p.callback,delete p.error;var g=this,a=new google.maps.DirectionsService;a.route(p,function(r,s){if(s===google.maps.DirectionsStatus.OK){for(var v in r.routes){r.routes.hasOwnProperty(v)&&g.routes.push(r.routes[v])}i.callback&&i.callback(g.routes)}else{i.error&&i.error(r,s)}})},h.prototype.removeRoutes=function(){this.routes=[]},h.prototype.getElevations=function(o){o=q({locations:[],path:!1,samples:256},o),o.locations.length>0&&o.locations[0].length>0&&(o.locations=f(d([o.locations],u,!1)));var n=o.callback;delete o.callback;var l=new google.maps.ElevationService;if(o.path){var g={path:o.locations,samples:o.samples};l.getElevationAlongPath(g,function(i,a){n&&"function"==typeof n&&n(i,a)})}else{delete o.path,delete o.samples,l.getElevationForLocations(o,function(i,a){n&&"function"==typeof n&&n(i,a)})}},h.prototype.cleanRoute=h.prototype.removePolylines,h.prototype.drawRoute=function(g){var a=this;this.getRoutes({origin:g.origin,destination:g.destination,travelMode:g.travelMode,waypoints:g.waypoints,unitSystem:g.unitSystem,error:g.error,callback:function(i){i.length>0&&(a.drawPolyline({path:i[i.length-1].overview_path,strokeColor:g.strokeColor,strokeOpacity:g.strokeOpacity,strokeWeight:g.strokeWeight}),g.callback&&g.callback(i[i.length-1]))}})},h.prototype.travelRoute=function(g){if(g.origin&&g.destination){this.getRoutes({origin:g.origin,destination:g.destination,travelMode:g.travelMode,waypoints:g.waypoints,error:g.error,callback:function(p){if(p.length>0&&g.start&&g.start(p[p.length-1]),p.length>0&&g.step){var x=p[p.length-1];if(x.legs.length>0){for(var y,w=x.legs[0].steps,v=0;y=w[v];v++){y.step_number=v,g.step(y,x.legs[0].steps.length-1)}}}p.length>0&&g.end&&g.end(p[p.length-1])}})}else{if(g.route&&g.route.legs.length>0){for(var a,i=g.route.legs[0].steps,l=0;a=i[l];l++){a.step_number=l,g.step(a)}}}},h.prototype.drawSteppedRoute=function(i){var a=this;if(i.origin&&i.destination){this.getRoutes({origin:i.origin,destination:i.destination,travelMode:i.travelMode,waypoints:i.waypoints,error:i.error,callback:function(x){if(x.length>0&&i.start&&i.start(x[x.length-1]),x.length>0&&i.step){var y=x[x.length-1];if(y.legs.length>0){for(var w,v=y.legs[0].steps,t=0;w=v[t];t++){w.step_number=t,a.drawPolyline({path:w.path,strokeColor:i.strokeColor,strokeOpacity:i.strokeOpacity,strokeWeight:i.strokeWeight}),i.step(w,y.legs[0].steps.length-1)}}}x.length>0&&i.end&&i.end(x[x.length-1])}})}else{if(i.route&&i.route.legs.length>0){for(var l,p=i.route.legs[0].steps,g=0;l=p[g];g++){l.step_number=g,a.drawPolyline({path:l.path,strokeColor:i.strokeColor,strokeOpacity:i.strokeOpacity,strokeWeight:i.strokeWeight}),i.step(l)}}}},h.Route=function(a){this.origin=a.origin,this.destination=a.destination,this.waypoints=a.waypoints,this.map=a.map,this.route=a.route,this.step_count=0,this.steps=this.route.legs[0].steps,this.steps_length=this.steps.length,this.polyline=this.map.drawPolyline({path:new google.maps.MVCArray,strokeColor:a.strokeColor,strokeOpacity:a.strokeOpacity,strokeWeight:a.strokeWeight}).getPath()},h.Route.prototype.getRoute=function(a){var g=this;this.map.getRoutes({origin:this.origin,destination:this.destination,travelMode:a.travelMode,waypoints:this.waypoints||[],error:a.error,callback:function(){g.route=e[0],a.callback&&a.callback.call(g)}})},h.Route.prototype.back=function(){if(this.step_count>0){this.step_count--;var g=this.route.legs[0].steps[this.step_count].path;for(var a in g){g.hasOwnProperty(a)&&this.polyline.pop()}}},h.Route.prototype.forward=function(){if(this.step_count<this.steps_length){var g=this.route.legs[0].steps[this.step_count].path;for(var a in g){g.hasOwnProperty(a)&&this.polyline.push(g[a])}this.step_count++}},h.prototype.checkGeofence=function(g,a,i){return i.containsLatLng(new google.maps.LatLng(g,a))},h.prototype.checkMarkerGeofence=function(i,a){if(i.fences){for(var l,p=0;l=i.fences[p];p++){var g=i.getPosition();this.checkGeofence(g.lat(),g.lng(),l)||a(i,l)}}},h.prototype.toImage=function(g){var g=g||{},a={};if(a.size=g.size||[this.el.clientWidth,this.el.clientHeight],a.lat=this.getCenter().lat(),a.lng=this.getCenter().lng(),this.markers.length>0){a.markers=[];for(var i=0;i<this.markers.length;i++){a.markers.push({lat:this.markers[i].getPosition().lat(),lng:this.markers[i].getPosition().lng()})}}if(this.polylines.length>0){var l=this.polylines[0];a.polyline={},a.polyline.path=google.maps.geometry.encoding.encodePath(l.getPath()),a.polyline.strokeColor=l.strokeColor,a.polyline.strokeOpacity=l.strokeOpacity,a.polyline.strokeWeight=l.strokeWeight}return h.staticMapURL(a)},h.staticMapURL=function(T){function F(g,a){if("#"===g[0]&&(g=g.replace("#","0x"),a)){if(a=parseFloat(a),a=Math.min(1,Math.max(a,0)),0===a){return"0x00000000"}a=(255*a).toString(16),1===a.length&&(a+=a),g=g.slice(0,8)+a}return g}var J,K=[],H="http://maps.googleapis.com/maps/api/staticmap";T.url&&(H=T.url,delete T.url),H+="?";var G=T.markers;delete T.markers,!G&&T.marker&&(G=[T.marker],delete T.marker);var P=T.styles;delete T.styles;var X=T.polyline;if(delete T.polyline,T.center){K.push("center="+T.center),delete T.center}else{if(T.address){K.push("center="+T.address),delete T.address}else{if(T.lat){K.push(["center=",T.lat,",",T.lng].join("")),delete T.lat,delete T.lng}else{if(T.visible){var N=encodeURI(T.visible.join("|"));K.push("visible="+N)}}}}var I=T.size;I?(I.join&&(I=I.join("x")),delete T.size):I="630x300",K.push("size="+I),T.zoom||T.zoom===!1||(T.zoom=15);var R=T.hasOwnProperty("sensor")?!!T.sensor:!0;delete T.sensor,K.push("sensor="+R);for(var V in T){T.hasOwnProperty(V)&&K.push(V+"="+T[V])}if(G){for(var Q,E,U=0;J=G[U];U++){Q=[],J.size&&"normal"!==J.size?(Q.push("size:"+J.size),delete J.size):J.icon&&(Q.push("icon:"+encodeURI(J.icon)),delete J.icon),J.color&&(Q.push("color:"+J.color.replace("#","0x")),delete J.color),J.label&&(Q.push("label:"+J.label[0].toUpperCase()),delete J.label),E=J.address?J.address:J.lat+","+J.lng,delete J.address,delete J.lat,delete J.lng;for(var V in J){J.hasOwnProperty(V)&&Q.push(V+":"+J[V])}Q.length||0===U?(Q.push(E),Q=Q.join("|"),K.push("markers="+encodeURI(Q))):(Q=K.pop()+encodeURI("|"+E),K.push(Q))}}if(P){for(var U=0;U<P.length;U++){var S=[];P[U].featureType&&"all"!=P[U].featureType&&S.push("feature:"+P[U].featureType),P[U].elementType&&"all"!=P[U].elementType&&S.push("element:"+P[U].elementType);for(var M=0;M<P[U].stylers.length;M++){for(var A in P[U].stylers[M]){var D=P[U].stylers[M][A];("hue"==A||"color"==A)&&(D="0x"+D.substring(1)),S.push(A+":"+D)}}var O=S.join("|");""!=O&&K.push("style="+O)}}if(X){if(J=X,X=[],J.strokeWeight&&X.push("weight:"+parseInt(J.strokeWeight,10)),J.strokeColor){var C=F(J.strokeColor,J.strokeOpacity);X.push("color:"+C)}if(J.fillColor){var W=F(J.fillColor,J.fillOpacity);X.push("fillcolor:"+W)}var z=J.path;if(z.join){for(var Y,M=0;Y=z[M];M++){X.push(Y.join(","))}}else{X.push("enc:"+z)}X=X.join("|"),K.push("path="+encodeURI(X))}var B=window.devicePixelRatio||1;return K.push("scale="+B),K=K.join("&"),H+K},h.prototype.addMapType=function(g,a){if(!a.hasOwnProperty("getTileUrl")||"function"!=typeof a.getTileUrl){throw"'getTileUrl' function required."}a.tileSize=a.tileSize||new google.maps.Size(256,256);var i=new google.maps.ImageMapType(a);this.map.mapTypes.set(g,i)},h.prototype.addOverlayMapType=function(g){if(!g.hasOwnProperty("getTile")||"function"!=typeof g.getTile){throw"'getTile' function required."}var a=g.index;delete g.index,this.map.overlayMapTypes.insertAt(a,g)},h.prototype.removeOverlayMapType=function(a){this.map.overlayMapTypes.removeAt(a)},h.prototype.addStyle=function(g){var a=new google.maps.StyledMapType(g.styles,{name:g.styledMapName});this.map.mapTypes.set(g.mapTypeId,a)},h.prototype.setStyle=function(a){this.map.setMapTypeId(a)},h.prototype.createPanorama=function(a){return a.hasOwnProperty("lat")&&a.hasOwnProperty("lng")||(a.lat=this.getCenter().lat(),a.lng=this.getCenter().lng()),this.panorama=h.createPanorama(a),this.map.setStreetView(this.panorama),this.panorama},h.createPanorama=function(p){var t=j(p.el,p.context);p.position=new google.maps.LatLng(p.lat,p.lng),delete p.el,delete p.context,delete p.lat,delete p.lng;for(var v=["closeclick","links_changed","pano_changed","position_changed","pov_changed","resize","visible_changed"],l=q({visible:!0},p),i=0;i<v.length;i++){delete l[v[i]]}for(var g=new google.maps.StreetViewPanorama(t,l),i=0;i<v.length;i++){!function(a,n){p[n]&&google.maps.event.addListener(a,n,function(){p[n].apply(this)})}(g,v[i])}return g},h.prototype.on=function(g,a){return h.on(g,this,a)},h.prototype.off=function(a){h.off(a,this)},h.custom_events=["marker_added","marker_removed","polyline_added","polyline_removed","polygon_added","polygon_removed","geolocated","geolocation_failed"],h.on=function(g,a,i){if(-1==h.custom_events.indexOf(g)){return google.maps.event.addListener(a,g,i)}var l={handler:i,eventName:g};return a.registered_events[g]=a.registered_events[g]||[],a.registered_events[g].push(l),l},h.off=function(g,a){-1==h.custom_events.indexOf(g)?google.maps.event.clearListeners(a,g):a.registered_events[g]=[]},h.fire=function(i,a,l){if(-1==h.custom_events.indexOf(i)){google.maps.event.trigger(a,i,Array.prototype.slice.apply(arguments).slice(2))}else{if(i in l.registered_events){for(var p=l.registered_events[i],g=0;g<p.length;g++){!function(r,n,s){r.apply(n,[s])}(p[g].handler,l,a)}}}},h.geolocate=function(g){var a=g.always||g.complete;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(i){g.success(i),a&&a()},function(i){g.error(i),a&&a()},g.options):(g.not_supported(),a&&a())},h.geocode=function(g){this.geocoder=new google.maps.Geocoder;var a=g.callback;g.hasOwnProperty("lat")&&g.hasOwnProperty("lng")&&(g.latLng=new google.maps.LatLng(g.lat,g.lng)),delete g.lat,delete g.lng,delete g.callback,this.geocoder.geocode(g,function(i,l){a(i,l)})},google.maps.Polygon.prototype.getBounds||(google.maps.Polygon.prototype.getBounds=function(){for(var i,a=new google.maps.LatLngBounds,l=this.getPaths(),p=0;p<l.getLength();p++){i=l.getAt(p);for(var g=0;g<i.getLength();g++){a.extend(i.getAt(g))}}return a}),google.maps.Polygon.prototype.containsLatLng||(google.maps.Polygon.prototype.containsLatLng=function(C){var E=this.getBounds();if(null!==E&&!E.contains(C)){return !1}for(var x=!1,y=this.getPaths().getLength(),v=0;y>v;v++){for(var F=this.getPaths().getAt(v),A=F.getLength(),D=A-1,z=0;A>z;z++){var w=F.getAt(z),B=F.getAt(D);(w.lng()<C.lng()&&B.lng()>=C.lng()||B.lng()<C.lng()&&w.lng()>=C.lng())&&w.lat()+(C.lng()-w.lng())/(B.lng()-w.lng())*(B.lat()-w.lat())<C.lat()&&(x=!x),D=z}}return x}),google.maps.LatLngBounds.prototype.containsLatLng=function(a){return this.contains(a)},google.maps.Marker.prototype.setFences=function(a){this.fences=a},google.maps.Marker.prototype.addFence=function(a){this.fences.push(a)},google.maps.Marker.prototype.getId=function(){return this.__gm_id},Array.prototype.indexOf||(Array.prototype.indexOf=function(i){if(null==this){throw new TypeError}var a=Object(this),l=a.length>>>0;if(0===l){return -1}var p=0;if(arguments.length>1&&(p=Number(arguments[1]),p!=p?p=0:0!=p&&1/0!=p&&p!=-1/0&&(p=(p>0||-1)*Math.floor(Math.abs(p)))),p>=l){return -1}for(var g=p>=0?p:Math.max(l-Math.abs(p),0);l>g;g++){if(g in a&&a[g]===i){return g}}return -1}),h});