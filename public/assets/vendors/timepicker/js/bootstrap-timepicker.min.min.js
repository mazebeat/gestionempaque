/*!
 * Timepicker Component for Twitter Bootstrap
 *
 * Copyright 2013 Joris de Wit
 *
 * Contributors https://github.com/jdewit/bootstrap-timepicker/graphs/contributors
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */
(function(i,j,g,h){var f=function(a,b){this.widget="";this.$element=i(a);this.defaultTime=b.defaultTime;this.disableFocus=b.disableFocus;this.disableMousewheel=b.disableMousewheel;this.isOpen=b.isOpen;this.minuteStep=b.minuteStep;this.modalBackdrop=b.modalBackdrop;this.orientation=b.orientation;this.secondStep=b.secondStep;this.showInputs=b.showInputs;this.showMeridian=b.showMeridian;this.showSeconds=b.showSeconds;this.template=b.template;this.appendWidgetTo=b.appendWidgetTo;this.showWidgetOnAddonClick=b.showWidgetOnAddonClick;this._init()};f.prototype={constructor:f,_init:function(){var a=this;if(this.showWidgetOnAddonClick&&(this.$element.parent().hasClass("input-append")||this.$element.parent().hasClass("input-prepend"))){this.$element.parent(".input-append, .input-prepend").find(".add-on").on({"click.timepicker":i.proxy(this.showWidget,this)});this.$element.on({"focus.timepicker":i.proxy(this.highlightUnit,this),"click.timepicker":i.proxy(this.highlightUnit,this),"keydown.timepicker":i.proxy(this.elementKeydown,this),"blur.timepicker":i.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":i.proxy(this.mousewheel,this)})}else{if(this.template){this.$element.on({"focus.timepicker":i.proxy(this.showWidget,this),"click.timepicker":i.proxy(this.showWidget,this),"blur.timepicker":i.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":i.proxy(this.mousewheel,this)})}else{this.$element.on({"focus.timepicker":i.proxy(this.highlightUnit,this),"click.timepicker":i.proxy(this.highlightUnit,this),"keydown.timepicker":i.proxy(this.elementKeydown,this),"blur.timepicker":i.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":i.proxy(this.mousewheel,this)})}}if(this.template!==false){this.$widget=i(this.getTemplate()).on("click",i.proxy(this.widgetClick,this))}else{this.$widget=false}if(this.showInputs&&this.$widget!==false){this.$widget.find("input").each(function(){i(this).on({"click.timepicker":function(){i(this).select()},"keydown.timepicker":i.proxy(a.widgetKeydown,a),"keyup.timepicker":i.proxy(a.widgetKeyup,a)})})}this.setDefaultTime(this.defaultTime)},blurElement:function(){this.highlightedUnit=null;this.updateFromElementVal()},clear:function(){this.hour="";this.minute="";this.second="";this.meridian="";this.$element.val("")},decrementHour:function(){if(this.showMeridian){if(this.hour===1){this.hour=12}else{if(this.hour===12){this.hour--;return this.toggleMeridian()}else{if(this.hour===0){this.hour=11;return this.toggleMeridian()}else{this.hour--}}}}else{if(this.hour<=0){this.hour=23}else{this.hour--}}},decrementMinute:function(a){var b;if(a){b=this.minute-a}else{b=this.minute-this.minuteStep}if(b<0){this.decrementHour();this.minute=b+60}else{this.minute=b}},decrementSecond:function(){var a=this.second-this.secondStep;if(a<0){this.decrementMinute(true);this.second=a+60}else{this.second=a}},elementKeydown:function(a){switch(a.keyCode){case 9:case 27:this.updateFromElementVal();break;case 37:a.preventDefault();this.highlightPrevUnit();break;case 38:a.preventDefault();switch(this.highlightedUnit){case"hour":this.incrementHour();this.highlightHour();break;case"minute":this.incrementMinute();this.highlightMinute();break;case"second":this.incrementSecond();this.highlightSecond();break;case"meridian":this.toggleMeridian();this.highlightMeridian();break}this.update();break;case 39:a.preventDefault();this.highlightNextUnit();break;case 40:a.preventDefault();switch(this.highlightedUnit){case"hour":this.decrementHour();this.highlightHour();break;case"minute":this.decrementMinute();this.highlightMinute();break;case"second":this.decrementSecond();this.highlightSecond();break;case"meridian":this.toggleMeridian();this.highlightMeridian();break}this.update();break}},getCursorPosition:function(){var b=this.$element.get(0);if("selectionStart" in b){return b.selectionStart}else{if(g.selection){b.focus();var a=g.selection.createRange(),c=g.selection.createRange().text.length;a.moveStart("character",-b.value.length);return a.text.length-c}}},getTemplate:function(){var d,b,e,l,c,a;if(this.showInputs){b='<input type="text" class="bootstrap-timepicker-hour" maxlength="2"/>';e='<input type="text" class="bootstrap-timepicker-minute" maxlength="2"/>';l='<input type="text" class="bootstrap-timepicker-second" maxlength="2"/>';c='<input type="text" class="bootstrap-timepicker-meridian" maxlength="2"/>'}else{b='<span class="bootstrap-timepicker-hour"></span>';e='<span class="bootstrap-timepicker-minute"></span>';l='<span class="bootstrap-timepicker-second"></span>';c='<span class="bootstrap-timepicker-meridian"></span>'}a='<table><tr><td><a href="#" data-action="incrementHour"><i class="icon-chevron-up"></i></a></td><td class="separator">&nbsp;</td><td><a href="#" data-action="incrementMinute"><i class="icon-chevron-up"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="incrementSecond"><i class="icon-chevron-up"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td class="meridian-column"><a href="#" data-action="toggleMeridian"><i class="icon-chevron-up"></i></a></td>':"")+"</tr><tr><td>"+b+'</td> <td class="separator">:</td><td>'+e+"</td> "+(this.showSeconds?'<td class="separator">:</td><td>'+l+"</td>":"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td>'+c+"</td>":"")+'</tr><tr><td><a href="#" data-action="decrementHour"><i class="icon-chevron-down"></i></a></td><td class="separator"></td><td><a href="#" data-action="decrementMinute"><i class="icon-chevron-down"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="decrementSecond"><i class="icon-chevron-down"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td><a href="#" data-action="toggleMeridian"><i class="icon-chevron-down"></i></a></td>':"")+"</tr></table>";switch(this.template){case"modal":d='<div class="bootstrap-timepicker-widget modal hide fade in" data-backdrop="'+(this.modalBackdrop?"true":"false")+'"><div class="modal-header"><a href="#" class="close" data-dismiss="modal">Ã—</a><h3>Pick a Time</h3></div><div class="modal-content">'+a+'</div><div class="modal-footer"><a href="#" class="btn btn-primary" data-dismiss="modal">OK</a></div></div>';break;case"dropdown":d='<div class="bootstrap-timepicker-widget dropdown-menu">'+a+"</div>";break}return d},getTime:function(){if(this.hour===""){return""}return this.hour+":"+(this.minute.toString().length===1?"0"+this.minute:this.minute)+(this.showSeconds?":"+(this.second.toString().length===1?"0"+this.second:this.second):"")+(this.showMeridian?" "+this.meridian:"")},hideWidget:function(){if(this.isOpen===false){return}this.$element.trigger({type:"hide.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}});if(this.template==="modal"&&this.$widget.modal){this.$widget.modal("hide")}else{this.$widget.removeClass("open")}i(g).off("mousedown.timepicker, touchend.timepicker");this.isOpen=false;this.$widget.detach()},highlightUnit:function(){this.position=this.getCursorPosition();if(this.position>=0&&this.position<=2){this.highlightHour()}else{if(this.position>=3&&this.position<=5){this.highlightMinute()}else{if(this.position>=6&&this.position<=8){if(this.showSeconds){this.highlightSecond()}else{this.highlightMeridian()}}else{if(this.position>=9&&this.position<=11){this.highlightMeridian()}}}}},highlightNextUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMinute();break;case"minute":if(this.showSeconds){this.highlightSecond()}else{if(this.showMeridian){this.highlightMeridian()}else{this.highlightHour()}}break;case"second":if(this.showMeridian){this.highlightMeridian()}else{this.highlightHour()}break;case"meridian":this.highlightHour();break}},highlightPrevUnit:function(){switch(this.highlightedUnit){case"hour":if(this.showMeridian){this.highlightMeridian()}else{if(this.showSeconds){this.highlightSecond()}else{this.highlightMinute()}}break;case"minute":this.highlightHour();break;case"second":this.highlightMinute();break;case"meridian":if(this.showSeconds){this.highlightSecond()}else{this.highlightMinute()}break}},highlightHour:function(){var b=this.$element.get(0),a=this;this.highlightedUnit="hour";if(b.setSelectionRange){setTimeout(function(){if(a.hour<10){b.setSelectionRange(0,1)}else{b.setSelectionRange(0,2)}},0)}},highlightMinute:function(){var b=this.$element.get(0),a=this;this.highlightedUnit="minute";if(b.setSelectionRange){setTimeout(function(){if(a.hour<10){b.setSelectionRange(2,4)}else{b.setSelectionRange(3,5)}},0)}},highlightSecond:function(){var b=this.$element.get(0),a=this;this.highlightedUnit="second";if(b.setSelectionRange){setTimeout(function(){if(a.hour<10){b.setSelectionRange(5,7)}else{b.setSelectionRange(6,8)}},0)}},highlightMeridian:function(){var b=this.$element.get(0),a=this;this.highlightedUnit="meridian";if(b.setSelectionRange){if(this.showSeconds){setTimeout(function(){if(a.hour<10){b.setSelectionRange(8,10)}else{b.setSelectionRange(9,11)}},0)}else{setTimeout(function(){if(a.hour<10){b.setSelectionRange(5,7)}else{b.setSelectionRange(6,8)}},0)}}},incrementHour:function(){if(this.showMeridian){if(this.hour===11){this.hour++;return this.toggleMeridian()}else{if(this.hour===12){this.hour=0}}}if(this.hour===23){this.hour=0;return}this.hour++},incrementMinute:function(a){var b;if(a){b=this.minute+a}else{b=this.minute+this.minuteStep-(this.minute%this.minuteStep)}if(b>59){this.incrementHour();this.minute=b-60}else{this.minute=b}},incrementSecond:function(){var a=this.second+this.secondStep-(this.second%this.secondStep);if(a>59){this.incrementMinute(true);this.second=a-60}else{this.second=a}},mousewheel:function(b){if(this.disableMousewheel){return}b.preventDefault();b.stopPropagation();var a=b.originalEvent.wheelDelta||-b.originalEvent.detail,c=null;if(b.type==="mousewheel"){c=(b.originalEvent.wheelDelta*-1)}else{if(b.type==="DOMMouseScroll"){c=40*b.originalEvent.detail}}if(c){b.preventDefault();i(this).scrollTop(c+i(this).scrollTop())}switch(this.highlightedUnit){case"minute":if(a>0){this.incrementMinute()}else{this.decrementMinute()}this.highlightMinute();break;case"second":if(a>0){this.incrementSecond()}else{this.decrementSecond()}this.highlightSecond();break;case"meridian":this.toggleMeridian();this.highlightMeridian();break;default:if(a>0){this.incrementHour()}else{this.decrementHour()}this.highlightHour();break}return false},place:function(){if(this.isInline){return}var z=this.$widget.outerWidth(),d=this.$widget.outerHeight(),x=10,v=i(j).width(),A=i(j).height(),w=i(j).scrollTop();var a=parseInt(this.$element.parents().filter(function(){}).first().css("z-index"),10)+10;var e=this.component?this.component.parent().offset():this.$element.offset();var D=this.component?this.component.outerHeight(true):this.$element.outerHeight(false);var y=this.component?this.component.outerWidth(true):this.$element.outerWidth(false);var u=e.left,b=e.top;this.$widget.removeClass("timepicker-orient-top timepicker-orient-bottom timepicker-orient-right timepicker-orient-left");if(this.orientation.x!=="auto"){this.picker.addClass("datepicker-orient-"+this.orientation.x);if(this.orientation.x==="right"){u-=z-y}}else{this.$widget.addClass("timepicker-orient-left");if(e.left<0){u-=e.left-x}else{if(e.left+z>v){u=v-z-x}}}var B=this.orientation.y,c,C;if(B==="auto"){c=-w+e.top-d;C=w+A-(e.top+D+d);if(Math.max(c,C)===C){B="top"}else{B="bottom"}}this.$widget.addClass("timepicker-orient-"+B);if(B==="top"){b+=D}else{b-=d+parseInt(this.$widget.css("padding-top"),10)}this.$widget.css({top:b,left:u,zIndex:a})},remove:function(){i("document").off(".timepicker");if(this.$widget){this.$widget.remove()}delete this.$element.data().timepicker},setDefaultTime:function(d){if(!this.$element.val()){if(d==="current"){var l=new Date(),e=l.getHours(),b=l.getMinutes(),a=l.getSeconds(),c="AM";if(a!==0){a=Math.ceil(l.getSeconds()/this.secondStep)*this.secondStep;if(a===60){b+=1;a=0}}if(b!==0){b=Math.ceil(l.getMinutes()/this.minuteStep)*this.minuteStep;if(b===60){e+=1;b=0}}if(this.showMeridian){if(e===0){e=12}else{if(e>=12){if(e>12){e=e-12}c="PM"}else{c="AM"}}}this.hour=e;this.minute=b;this.second=a;this.meridian=c;this.update()}else{if(d===false){this.hour=0;this.minute=0;this.second=0;this.meridian="AM"}else{this.setTime(d)}}}else{this.updateFromElementVal()}},setTime:function(b,d){if(!b){this.clear();return}var c,n,a,m,e;if(typeof b==="object"&&b.getMonth){n=b.getHours();a=b.getMinutes();m=b.getSeconds();if(this.showMeridian){e="AM";if(n>12){e="PM";n=n%12}if(n===12){e="PM"}}}else{if(b.match(/p/i)!==null){e="PM"}else{e="AM"}b=b.replace(/[^0-9\:]/g,"");c=b.split(":");n=c[0]?c[0].toString():c.toString();a=c[1]?c[1].toString():"";m=c[2]?c[2].toString():"";if(n.length>4){m=n.substr(4,2)}if(n.length>2){a=n.substr(2,2);n=n.substr(0,2)}if(a.length>2){m=a.substr(2,2);a=a.substr(0,2)}if(m.length>2){m=m.substr(2,2)}n=parseInt(n,10);a=parseInt(a,10);m=parseInt(m,10);if(isNaN(n)){n=0}if(isNaN(a)){a=0}if(isNaN(m)){m=0}if(this.showMeridian){if(n<1){n=1}else{if(n>12){n=12}}}else{if(n>=24){n=23}else{if(n<0){n=0}}if(n<13&&e==="PM"){n=n+12}}if(a<0){a=0}else{if(a>=60){a=59}}if(this.showSeconds){if(isNaN(m)){m=0}else{if(m<0){m=0}else{if(m>=60){m=59}}}}}this.hour=n;this.minute=a;this.second=m;this.meridian=e;this.update(d)},showWidget:function(){if(this.isOpen){return}if(this.$element.is(":disabled")){return}this.$widget.appendTo(this.appendWidgetTo);var a=this;i(g).on("mousedown.timepicker, touchend.timepicker",function(b){if(!(a.$element.parent().find(b.target).length||a.$widget.is(b.target)||a.$widget.find(b.target).length)){a.hideWidget()}});this.$element.trigger({type:"show.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}});this.place();if(this.disableFocus){this.$element.blur()}if(this.hour===""){if(this.defaultTime){this.setDefaultTime(this.defaultTime)}else{this.setTime("0:0:0")}}if(this.template==="modal"&&this.$widget.modal){this.$widget.modal("show").on("hidden",i.proxy(this.hideWidget,this))}else{if(this.isOpen===false){this.$widget.addClass("open")}}this.isOpen=true},toggleMeridian:function(){this.meridian=this.meridian==="AM"?"PM":"AM"},update:function(a){this.updateElement();if(!a){this.updateWidget()}this.$element.trigger({type:"changeTime.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}})},updateElement:function(){this.$element.val(this.getTime()).change()},updateFromElementVal:function(){this.setTime(this.$element.val())},updateWidget:function(){if(this.$widget===false){return}var c=this.hour,a=this.minute.toString().length===1?"0"+this.minute:this.minute,b=this.second.toString().length===1?"0"+this.second:this.second;if(this.showInputs){this.$widget.find("input.bootstrap-timepicker-hour").val(c);this.$widget.find("input.bootstrap-timepicker-minute").val(a);if(this.showSeconds){this.$widget.find("input.bootstrap-timepicker-second").val(b)}if(this.showMeridian){this.$widget.find("input.bootstrap-timepicker-meridian").val(this.meridian)}}else{this.$widget.find("span.bootstrap-timepicker-hour").text(c);this.$widget.find("span.bootstrap-timepicker-minute").text(a);if(this.showSeconds){this.$widget.find("span.bootstrap-timepicker-second").text(b)}if(this.showMeridian){this.$widget.find("span.bootstrap-timepicker-meridian").text(this.meridian)}}},updateFromWidgetInputs:function(){if(this.$widget===false){return}var a=this.$widget.find("input.bootstrap-timepicker-hour").val()+":"+this.$widget.find("input.bootstrap-timepicker-minute").val()+(this.showSeconds?":"+this.$widget.find("input.bootstrap-timepicker-second").val():"")+(this.showMeridian?this.$widget.find("input.bootstrap-timepicker-meridian").val():"");this.setTime(a,true)},widgetClick:function(b){b.stopPropagation();b.preventDefault();var a=i(b.target),c=a.closest("a").data("action");if(c){this[c]()}this.update();if(a.is("input")){a.get(0).setSelectionRange(0,2)}},widgetKeydown:function(b){var a=i(b.target),c=a.attr("class").replace("bootstrap-timepicker-","");switch(b.keyCode){case 9:if((this.showMeridian&&c==="meridian")||(this.showSeconds&&c==="second")||(!this.showMeridian&&!this.showSeconds&&c==="minute")){return this.hideWidget()}break;case 27:this.hideWidget();break;case 38:b.preventDefault();switch(c){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian();break}this.setTime(this.getTime());a.get(0).setSelectionRange(0,2);break;case 40:b.preventDefault();switch(c){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian();break}this.setTime(this.getTime());a.get(0).setSelectionRange(0,2);break}},widgetKeyup:function(a){if((a.keyCode===65)||(a.keyCode===77)||(a.keyCode===80)||(a.keyCode===46)||(a.keyCode===8)||(a.keyCode>=46&&a.keyCode<=57)||(a.keyCode>=96&&a.keyCode<=105)){this.updateFromWidgetInputs()}}};i.fn.timepicker=function(a){var b=Array.apply(null,arguments);b.shift();return this.each(function(){var c=i(this),d=c.data("timepicker"),e=typeof a==="object"&&a;if(!d){c.data("timepicker",(d=new f(this,i.extend({},i.fn.timepicker.defaults,e,i(this).data()))))}if(typeof a==="string"){d[a].apply(d,b)}})};i.fn.timepicker.defaults={defaultTime:"current",disableFocus:false,disableMousewheel:false,isOpen:false,minuteStep:15,modalBackdrop:false,orientation:{x:"auto",y:"auto"},secondStep:15,showSeconds:false,showInputs:true,showMeridian:true,template:"dropdown",appendWidgetTo:"body",showWidgetOnAddonClick:true};i.fn.timepicker.Constructor=f})(jQuery,window,document);