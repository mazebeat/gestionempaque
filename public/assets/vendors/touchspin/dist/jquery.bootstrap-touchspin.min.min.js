(function(g){var e=0;function f(b,a){return b+".touchspin_"+a}function h(b,a){return g.map(b,function(c){return f(c,a)})}g.fn.TouchSpin=function(b){if(b==="destroy"){this.each(function(){var j=g(this),d=j.data();g(document).off(h(["mouseup","touchend","touchcancel","mousemove","touchmove","scroll","scrollstart"],d.spinnerid).join(" "))});return}var a={min:0,max:100,initval:"",step:1,decimals:0,stepinterval:100,forcestepdivisibility:"round",stepintervaldelay:500,verticalbuttons:false,verticalupclass:"glyphicon glyphicon-chevron-up",verticaldownclass:"glyphicon glyphicon-chevron-down",prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:true,boostat:10,maxboostedstep:false,mousewheel:true,buttondown_class:"btn btn-default",buttonup_class:"btn btn-default"};var c={min:"min",max:"max",initval:"init-val",step:"step",decimals:"decimals",stepinterval:"step-interval",verticalbuttons:"vertical-buttons",verticalupclass:"vertical-up-class",verticaldownclass:"vertical-down-class",forcestepdivisibility:"force-step-divisibility",stepintervaldelay:"step-interval-delay",prefix:"prefix",postfix:"postfix",prefix_extraclass:"prefix-extra-class",postfix_extraclass:"postfix-extra-class",booster:"booster",boostat:"boostat",maxboostedstep:"max-boosted-step",mousewheel:"mouse-wheel",buttondown_class:"button-down-class",buttonup_class:"button-up-class"};return this.each(function(){var S,X=g(this),ab=X.data(),T,al,ah,an,V,am,af,Z=0,ar=false;W();function W(){if(X.data("alreadyinitialized")){return}X.data("alreadyinitialized",true);e+=1;X.data("spinnerid",e);if(!X.is("input")){console.log("Must be an input.");return}at();ap();ad();ao();aq();U();d();aj();al.input.css("display","block")}function ap(){if(S.initval!==""&&X.val()===""){X.val(S.initval)}}function R(i){Y(i);ad();var j=al.input.val();if(j!==""){j=Number(al.input.val());al.input.val(j.toFixed(S.decimals))}}function at(){S=g.extend({},a,ab,Q(),b)}function Q(){var i={};g.each(c,function(k,j){var l="bts-"+j+"";if(X.is("[data-"+l+"]")){i[k]=X.data(l)}});return i}function Y(i){S=g.extend({},S,i)}function ao(){var i=X.val(),j=X.parent();if(i!==""){i=Number(i).toFixed(S.decimals)}X.data("initvalue",i).val(i);X.addClass("form-control");if(j.hasClass("input-group")){au(j)}else{ae()}}function au(n){n.addClass("bootstrap-touchspin");var k=X.prev(),l=X.next();var i,o,m='<span class="input-group-addon bootstrap-touchspin-prefix">'+S.prefix+"</span>",j='<span class="input-group-addon bootstrap-touchspin-postfix">'+S.postfix+"</span>";if(k.hasClass("input-group-btn")){i='<button class="'+S.buttondown_class+' bootstrap-touchspin-down" type="button">-</button>';k.append(i)}else{i='<span class="input-group-btn"><button class="'+S.buttondown_class+' bootstrap-touchspin-down" type="button">-</button></span>';g(i).insertBefore(X)}if(l.hasClass("input-group-btn")){o='<button class="'+S.buttonup_class+' bootstrap-touchspin-up" type="button">+</button>';l.prepend(o)}else{o='<span class="input-group-btn"><button class="'+S.buttonup_class+' bootstrap-touchspin-up" type="button">+</button></span>';g(o).insertAfter(X)}g(m).insertBefore(X);g(j).insertAfter(X);T=n}function ae(){var i;if(S.verticalbuttons){i='<div class="input-group bootstrap-touchspin"><span class="input-group-addon bootstrap-touchspin-prefix">'+S.prefix+'</span><span class="input-group-addon bootstrap-touchspin-postfix">'+S.postfix+'</span><span class="input-group-btn-vertical"><button class="'+S.buttondown_class+' bootstrap-touchspin-up" type="button"><i class="'+S.verticalupclass+'"></i></button><button class="'+S.buttonup_class+' bootstrap-touchspin-down" type="button"><i class="'+S.verticaldownclass+'"></i></button></span></div>'}else{i='<div class="input-group bootstrap-touchspin"><span class="input-group-btn"><button class="'+S.buttondown_class+' bootstrap-touchspin-down" type="button">-</button></span><span class="input-group-addon bootstrap-touchspin-prefix">'+S.prefix+'</span><span class="input-group-addon bootstrap-touchspin-postfix">'+S.postfix+'</span><span class="input-group-btn"><button class="'+S.buttonup_class+' bootstrap-touchspin-up" type="button">+</button></span></div>'}T=g(i).insertBefore(X);g(".bootstrap-touchspin-prefix",T).after(X);if(X.hasClass("input-sm")){T.addClass("input-group-sm")}else{if(X.hasClass("input-lg")){T.addClass("input-group-lg")}}}function aq(){al={down:g(".bootstrap-touchspin-down",T),up:g(".bootstrap-touchspin-up",T),input:g("input",T),prefix:g(".bootstrap-touchspin-prefix",T).addClass(S.prefix_extraclass),postfix:g(".bootstrap-touchspin-postfix",T).addClass(S.postfix_extraclass)}}function U(){if(S.prefix===""){al.prefix.hide()}if(S.postfix===""){al.postfix.hide()}}function d(){X.on("keydown",function(i){var j=i.keyCode||i.which;if(j===38){if(ar!=="up"){ai();ac()}i.preventDefault()}else{if(j===40){if(ar!=="down"){P();O()}i.preventDefault()}}});X.on("keyup",function(i){var j=i.keyCode||i.which;if(j===38){ak()}else{if(j===40){ak()}}});X.on("blur",function(){ad()});al.down.on("keydown",function(i){var j=i.keyCode||i.which;if(j===32||j===13){if(ar!=="down"){P();O()}i.preventDefault()}});al.down.on("keyup",function(i){var j=i.keyCode||i.which;if(j===32||j===13){ak()}});al.up.on("keydown",function(i){var j=i.keyCode||i.which;if(j===32||j===13){if(ar!=="up"){ai();ac()}i.preventDefault()}});al.up.on("keyup",function(i){var j=i.keyCode||i.which;if(j===32||j===13){ak()}});al.down.on("mousedown.touchspin",function(i){al.down.off("touchstart.touchspin");if(X.is(":disabled")){return}P();O();i.preventDefault();i.stopPropagation()});al.down.on("touchstart.touchspin",function(i){al.down.off("mousedown.touchspin");if(X.is(":disabled")){return}P();O();i.preventDefault();i.stopPropagation()});al.up.on("mousedown.touchspin",function(i){al.up.off("touchstart.touchspin");if(X.is(":disabled")){return}ai();ac();i.preventDefault();i.stopPropagation()});al.up.on("touchstart.touchspin",function(i){al.up.off("mousedown.touchspin");if(X.is(":disabled")){return}ai();ac();i.preventDefault();i.stopPropagation()});al.up.on("mouseout touchleave touchend touchcancel",function(i){if(!ar){return}i.stopPropagation();ak()});al.down.on("mouseout touchleave touchend touchcancel",function(i){if(!ar){return}i.stopPropagation();ak()});al.down.on("mousemove touchmove",function(i){if(!ar){return}i.stopPropagation();i.preventDefault()});al.up.on("mousemove touchmove",function(i){if(!ar){return}i.stopPropagation();i.preventDefault()});g(document).on(h(["mouseup","touchend","touchcancel"],e).join(" "),function(i){if(!ar){return}i.preventDefault();ak()});g(document).on(h(["mousemove","touchmove","scroll","scrollstart"],e).join(" "),function(i){if(!ar){return}i.preventDefault();ak()});X.on("mousewheel DOMMouseScroll",function(j){if(!S.mousewheel||!X.is(":focus")){return}var i=j.originalEvent.wheelDelta||-j.originalEvent.deltaY||-j.originalEvent.detail;j.stopPropagation();j.preventDefault();if(i<0){P()}else{ai()}})}function aj(){X.on("touchspin.uponce",function(){ak();ai()});X.on("touchspin.downonce",function(){ak();P()});X.on("touchspin.startupspin",function(){ac()});X.on("touchspin.startdownspin",function(){O()});X.on("touchspin.stopspin",function(){ak()});X.on("touchspin.updatesettings",function(j,i){R(i)})}function aa(i){switch(S.forcestepdivisibility){case"round":return(Math.round(i/S.step)*S.step).toFixed(S.decimals);case"floor":return(Math.floor(i/S.step)*S.step).toFixed(S.decimals);case"ceil":return(Math.ceil(i/S.step)*S.step).toFixed(S.decimals);default:return i}}function ad(){var i,k,j;i=X.val();if(i===""){return}if(S.decimals>0&&i==="."){return}k=parseFloat(i);if(isNaN(k)){k=0}j=k;if(k.toString()!==i){j=k}if(k<S.min){j=S.min}if(k>S.max){j=S.max}j=aa(j);if(Number(i).toString()!==j.toString()){X.val(j);X.trigger("change")}}function ag(){if(!S.booster){return S.step}else{var i=Math.pow(2,Math.floor(Z/S.boostat))*S.step;if(S.maxboostedstep){if(i>S.maxboostedstep){i=S.maxboostedstep;ah=Math.round((ah/i))*i}}return Math.max(S.step,i)}}function ai(){ad();ah=parseFloat(al.input.val());if(isNaN(ah)){ah=0}var i=ah,j=ag();ah=ah+j;if(ah>S.max){ah=S.max;X.trigger("touchspin.on.max");ak()}al.input.val(Number(ah).toFixed(S.decimals));if(i!==ah){X.trigger("change")}}function P(){ad();ah=parseFloat(al.input.val());if(isNaN(ah)){ah=0}var i=ah,j=ag();ah=ah-j;if(ah<S.min){ah=S.min;X.trigger("touchspin.on.min");ak()}al.input.val(ah.toFixed(S.decimals));if(i!==ah){X.trigger("change")}}function O(){ak();Z=0;ar="down";X.trigger("touchspin.on.startspin");X.trigger("touchspin.on.startdownspin");am=setTimeout(function(){an=setInterval(function(){Z++;P()},S.stepinterval)},S.stepintervaldelay)}function ac(){ak();Z=0;ar="up";X.trigger("touchspin.on.startspin");X.trigger("touchspin.on.startupspin");af=setTimeout(function(){V=setInterval(function(){Z++;ai()},S.stepinterval)},S.stepintervaldelay)}function ak(){clearTimeout(am);clearTimeout(af);clearInterval(an);clearInterval(V);switch(ar){case"up":X.trigger("touchspin.on.stopupspin");X.trigger("touchspin.on.stopspin");break;case"down":X.trigger("touchspin.on.stopdownspin");X.trigger("touchspin.on.stopspin");break}Z=0;ar=false}})}})(jQuery);