/*!
 Scroller 1.2.1
 2011-2014 SpryMedia Ltd - datatables.net/license
*/
(function(d,a,c){var b=function(j){var i=function(f,e){!this instanceof i?alert("Scroller warning: Scroller must be initialised with the 'new' keyword."):("undefined"==typeof e&&(e={}),this.s={dt:f,tableTop:0,tableBottom:0,redrawTop:0,redrawBottom:0,autoHeight:!0,viewportRows:0,stateTO:null,drawTO:null,heights:{jump:null,page:null,virtual:null,scroll:null,row:null,viewport:null},topRowFloat:0,scrollDrawDiff:null},this.s=j.extend(this.s,i.oDefaults,e),this.s.heights.row=this.s.rowHeight,this.dom={force:a.createElement("div"),scroller:null,table:null},this.s.dt.oScroller=this,this._fnConstruct())};i.prototype={fnRowToPixels:function(f,e,h){f=h?this._domain("virtualToPhysical",f*this.s.heights.row):this.s.baseScrollTop+(f-this.s.baseRowTop)*this.s.heights.row;return e||e===c?parseInt(f,10):f},fnPixelsToRow:function(f,e,k){var h=f-this.s.baseScrollTop,f=k?this._domain("physicalToVirtual",f)/this.s.heights.row:h/this.s.heights.row+this.s.baseRowTop;return e||e===c?parseInt(f,10):f},fnScrollToRow:function(h,e){var n=this,m=!1,k=this.fnRowToPixels(h),l=h-(this.s.displayBuffer-1)/2*this.s.viewportRows;0>l&&(l=0);if((k>this.s.redrawBottom||k<this.s.redrawTop)&&this.s.dt._iDisplayStart!==l){m=!0,k=this.fnRowToPixels(h,!1,!0)}"undefined"==typeof e||e?(this.s.ani=m,j(this.dom.scroller).animate({scrollTop:k},function(){setTimeout(function(){n.s.ani=!1},0)})):j(this.dom.scroller).scrollTop(k)},fnMeasure:function(f){this.s.autoHeight&&this._fnCalcRowHeight();var e=this.s.heights;e.viewport=j(this.dom.scroller).height();this.s.viewportRows=parseInt(e.viewport/e.row,10)+1;this.s.dt._iDisplayLength=this.s.viewportRows*this.s.displayBuffer;("undefined"==typeof f||f)&&this.s.dt.oInstance.fnDraw()},_fnConstruct:function(){var f=this;if(this.s.dt.oFeatures.bPaginate){this.dom.force.style.position="absolute";this.dom.force.style.top="0px";this.dom.force.style.left="0px";this.dom.force.style.width="1px";this.dom.scroller=j("div."+this.s.dt.oClasses.sScrollBody,this.s.dt.nTableWrapper)[0];this.dom.scroller.appendChild(this.dom.force);this.dom.scroller.style.position="relative";this.dom.table=j(">table",this.dom.scroller)[0];this.dom.table.style.position="absolute";this.dom.table.style.top="0px";this.dom.table.style.left="0px";j(this.s.dt.nTableWrapper).addClass("DTS");this.s.loadingIndicator&&j(this.dom.scroller.parentNode).css("position","relative").append('<div class="DTS_Loading">'+this.s.dt.oLanguage.sLoadingRecords+"</div>");this.s.heights.row&&"auto"!=this.s.heights.row&&(this.s.autoHeight=!1);this.fnMeasure(!1);j(this.dom.scroller).on("scroll.DTS",function(){f._fnScroll.call(f)});j(this.dom.scroller).on("touchstart.DTS",function(){f._fnScroll.call(f)});this.s.dt.aoDrawCallback.push({fn:function(){f.s.dt.bInitialised&&f._fnDrawCallback.call(f)},sName:"Scroller"});j(d).on("resize.DTS",function(){f._fnInfo()});var e=!0;this.s.dt.oApi._fnCallbackReg(this.s.dt,"aoStateSaveParams",function(k,h){if(e&&f.s.dt.oLoadedState){h.iScroller=f.s.dt.oLoadedState.iScroller;e=false}else{h.iScroller=f.dom.scroller.scrollTop}},"Scroller_State");this.s.dt.aoDestroyCallback.push({sName:"Scroller",fn:function(){j(d).off("resize.DTS");j(f.dom.scroller).off("touchstart.DTS scroll.DTS");j(f.s.dt.nTableWrapper).removeClass("DTS");j("div.DTS_Loading",f.dom.scroller.parentNode).remove();f.dom.table.style.position="";f.dom.table.style.top="";f.dom.table.style.left=""}})}else{this.s.dt.oApi._fnLog(this.s.dt,0,"Pagination must be enabled for Scroller")}},_fnScroll:function(){var f=this,e=this.s.heights,l=this.dom.scroller.scrollTop,k;if(!this.s.skip){if(this.s.dt.bFiltered||this.s.dt.bSorted){this.s.lastScrollTop=0}else{this._fnInfo();clearTimeout(this.s.stateTO);this.s.stateTO=setTimeout(function(){f.s.dt.oApi._fnSaveState(f.s.dt)},250);if(l<this.s.redrawTop||l>this.s.redrawBottom){var h=Math.ceil((this.s.displayBuffer-1)/2*this.s.viewportRows);Math.abs(l-this.s.lastScrollTop)>e.viewport||this.s.ani?(k=parseInt(this._domain("physicalToVirtual",l)/e.row,10)-h,this.s.topRowFloat=this._domain("physicalToVirtual",l)/e.row):(k=this.fnPixelsToRow(l)-h,this.s.topRowFloat=this.fnPixelsToRow(l,!1));0>=k?k=0:k+this.s.dt._iDisplayLength>this.s.dt.fnRecordsDisplay()?(k=this.s.dt.fnRecordsDisplay()-this.s.dt._iDisplayLength,0>k&&(k=0)):0!==k%2&&k++;k!=this.s.dt._iDisplayStart&&(this.s.tableTop=j(this.s.dt.nTable).offset().top,this.s.tableBottom=j(this.s.dt.nTable).height()+this.s.tableTop,e=function(){if(f.s.scrollDrawReq===null){f.s.scrollDrawReq=l}f.s.dt._iDisplayStart=k;f.s.dt.oApi._fnCalculateEnd&&f.s.dt.oApi._fnCalculateEnd(f.s.dt);f.s.dt.oApi._fnDraw(f.s.dt)},this.s.dt.oFeatures.bServerSide?(clearTimeout(this.s.drawTO),this.s.drawTO=setTimeout(e,this.s.serverWait)):e())}this.s.lastScrollTop=l}}},_domain:function(k,h){var o=this.s.heights,n;if(o.virtual===o.scroll){n=(o.virtual-o.viewport)/(o.scroll-o.viewport);if("virtualToPhysical"===k){return h/n}if("physicalToVirtual"===k){return h*n}}var m=(o.scroll-o.viewport)/2,l=(o.virtual-o.viewport)/2;n=l/(m*m);if("virtualToPhysical"===k){if(h<l){return Math.pow(h/n,0.5)}h=2*l-h;return 0>h?o.scroll:2*m-Math.pow(h/n,0.5)}if("physicalToVirtual"===k){if(h<m){return h*h*n}h=2*m-h;return 0>h?o.virtual:2*l-h*h*n}},_fnDrawCallback:function(){var k=this,e=this.s.heights,q=this.dom.scroller.scrollTop,p=j(this.s.dt.nTable).height(),n=this.s.dt._iDisplayStart,o=this.s.dt._iDisplayLength,m=this.s.dt.fnRecordsDisplay();this.s.skip=!0;this._fnScrollForce();q=0===n?this.s.topRowFloat*e.row:n+o>=m?e.scroll-(m-this.s.topRowFloat)*e.row:this._domain("virtualToPhysical",this.s.topRowFloat*e.row);this.dom.scroller.scrollTop=q;this.s.baseScrollTop=q;this.s.baseRowTop=this.s.topRowFloat;var l=q-(this.s.topRowFloat-n)*e.row;0===n?l=0:n+o>=m&&(l=e.scroll-p);this.dom.table.style.top=l+"px";this.s.tableTop=l;this.s.tableBottom=p+this.s.tableTop;p=(q-this.s.tableTop)*this.s.boundaryScale;this.s.redrawTop=q-p;this.s.redrawBottom=q+p;this.s.skip=!1;setTimeout(function(){k._fnInfo.call(k)},0);this.s.dt.oFeatures.bStateSave&&null!==this.s.dt.oLoadedState&&"undefined"!=typeof this.s.dt.oLoadedState.iScroller&&((q=this.s.dt.sAjaxSource||k.s.dt.ajax?!0:!1)&&2==this.s.dt.iDraw||!q&&1==this.s.dt.iDraw)&&setTimeout(function(){j(k.dom.scroller).scrollTop(k.s.dt.oLoadedState.iScroller);k.s.redrawTop=k.s.dt.oLoadedState.iScroller-e.viewport/2},0)},_fnScrollForce:function(){var e=this.s.heights;e.virtual=e.row*this.s.dt.fnRecordsDisplay();e.scroll=e.virtual;1000000<e.scroll&&(e.scroll=1000000);this.dom.force.style.height=e.scroll+"px"},_fnCalcRowHeight:function(){var f=this.s.dt.nTable,e=f.cloneNode(!1),k=j("<tbody/>").appendTo(e),h=j('<div class="'+this.s.dt.oClasses.sWrapper+' DTS"><div class="'+this.s.dt.oClasses.sScrollWrapper+'"><div class="'+this.s.dt.oClasses.sScrollBody+'"></div></div></div>');for(j("tbody tr:lt(4)",f).clone().appendTo(k);3>j("tr",k).length;){k.append("<tr><td>&nbsp;</td></tr>")}j("div."+this.s.dt.oClasses.sScrollBody,h).append(e);h.appendTo(this.s.dt.nHolding);this.s.heights.row=j("tr",k).eq(1).outerHeight();h.remove()},_fnInfo:function(){if(this.s.dt.oFeatures.bInfo){var h=this.s.dt,e=this.dom.scroller.scrollTop,m=Math.floor(this.fnPixelsToRow(e,!1,this.s.ani)+1),l=h.fnRecordsTotal(),k=h.fnRecordsDisplay(),e=Math.ceil(this.fnPixelsToRow(e+this.s.heights.viewport,!1,this.s.ani)),e=k<e?k:e,m=h.fnFormatNumber(m),e=h.fnFormatNumber(e),l=h.fnFormatNumber(l),k=h.fnFormatNumber(k),k=0===h.fnRecordsDisplay()&&h.fnRecordsDisplay()==h.fnRecordsTotal()?h.oLanguage.sInfoEmpty+h.oLanguage.sInfoPostFix:0===h.fnRecordsDisplay()?h.oLanguage.sInfoEmpty+" "+h.oLanguage.sInfoFiltered.replace("_MAX_",l)+h.oLanguage.sInfoPostFix:h.fnRecordsDisplay()==h.fnRecordsTotal()?h.oLanguage.sInfo.replace("_START_",m).replace("_END_",e).replace("_TOTAL_",k)+h.oLanguage.sInfoPostFix:h.oLanguage.sInfo.replace("_START_",m).replace("_END_",e).replace("_TOTAL_",k)+" "+h.oLanguage.sInfoFiltered.replace("_MAX_",h.fnFormatNumber(h.fnRecordsTotal()))+h.oLanguage.sInfoPostFix,h=h.aanFeatures.i;if("undefined"!=typeof h){l=0;for(m=h.length;l<m;l++){j(h[l]).html(k)}}}}};i.defaults={trace:!1,rowHeight:"auto",serverWait:200,displayBuffer:9,boundaryScale:0.5,loadingIndicator:!1};i.oDefaults=i.defaults;i.version="1.2.1";"function"==typeof j.fn.dataTable&&"function"==typeof j.fn.dataTableExt.fnVersionCheck&&j.fn.dataTableExt.fnVersionCheck("1.9.0")?j.fn.dataTableExt.aoFeatures.push({fnInit:function(f){var e=f.oInit;return(new i(f,e.scroller||e.oScroller||{})).dom.wrapper},cFeature:"S",sFeature:"Scroller"}):alert("Warning: Scroller requires DataTables 1.9.0 or greater - www.datatables.net/download");j.fn.dataTable.Scroller=i;j.fn.DataTable.Scroller=i;if(j.fn.dataTable.Api){var g=j.fn.dataTable.Api;g.register("scroller().rowToPixels()",function(f,e,k){var h=this.context;if(h.length&&h[0].oScroller){return h[0].oScroller.fnRowToPixels(f,e,k)}});g.register("scroller().pixelsToRow()",function(f,e,k){var h=this.context;if(h.length&&h[0].oScroller){return h[0].oScroller.fnPixelsToRow(f,e,k)}});g.register("scroller().scrollToRow()",function(f,e){this.iterator("table",function(h){h.oScroller&&h.oScroller.fnScrollToRow(f,e)});return this});g.register("scroller().measure()",function(e){this.iterator("table",function(f){f.oScroller&&f.oScroller.fnMeasure(e)});return this})}return i};"function"===typeof define&&define.amd?define("datatables-scroller",["jquery","datatables"],b):jQuery&&!jQuery.fn.dataTable.Scroller&&b(jQuery,jQuery.fn.dataTable)})(window,document);